webpackJsonp([1],{"4UON":function(t,e){},"4wdT":function(t,e){},Ak7i:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={};n.d(a,"userInfo",function(){return Z});var s=n("7+uW"),o={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("div",{attrs:{id:"toast"}}),this._v(" "),e("transition",{attrs:{name:this.transitionName}},[e("router-view")],1)],1)},staticRenderFns:[]};var r=n("VU/8")({name:"App",data:function(){return{transitionName:""}},watch:{$route:function(t,e){var n=t.path.split("/").filter(function(t){return t}).length,a=e.path.split("/").filter(function(t){return t}).length;this.transitionName=n<a?"slide-right":"slide-left"}}},o,!1,function(t){n("Wej4")},"data-v-0e38e8c4",null).exports,i=n("/ocq"),c=n("Xxa5"),l=n.n(c),u=n("exGp"),p=n.n(u),m=n("Dd8w"),d=n.n(m),g=n("L6bb"),f=n.n(g);function v(t){var e=document.getElementById("toast")||null;if(e&&""===e.innerHTML&&(""===e.className||"hide"===e.className)){var n={duration:t.duration||2e3,title:t.title||""};e.innerHTML=n.title,e.className="show",setTimeout(function(){e.className="hide",setTimeout(function(){e.innerHTML=""},400)},n.duration)}}function b(t){var e=new RegExp("(^| )"+t+"=([^;]*)(;|$)");return document.cookie.match(e)?unescape(document.cookie.match(e)[2]):null}function h(t,e){localStorage.setItem(t,e)}function k(t,e){var n,a,s,o,r,i,c,l,u,p,m,d,g=e||"1",f=new Date(t),v=new Date;return n=parseInt(f.getFullYear()),a=parseInt(f.getMonth())+1,s=parseInt(f.getDate()),o=parseInt(f.getHours()),r=parseInt(f.getMinutes()),i=parseInt(f.getSeconds()),c=parseInt(v.getFullYear()),l=parseInt(v.getMonth())+1,u=parseInt(v.getDate()),p=parseInt(v.getHours()),m=parseInt(v.getMinutes()),d=parseInt(v.getSeconds()),"2"===g?n+"年"+a+"月"+s+"号 "+o+"点"+r+"分":c-n>1?c-n+"年前"+a+"月"+s+"号"+o+"点":c-n>0?"去年"+a+"月"+s+"号"+o+"点":l-a>0?"今年"+a+"月"+s+"号"+o+"点":u-s>1?u-s+"天前"+o+"点":u-s>0?"昨天"+o+"点":p-o>0?p-o+"小时前":m-r>0?m-r+"分钟前":d-i>0?d-i+"秒前":"刚刚"}var C=n("NYxO"),_=/^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/,I=/^[a-z0-9]{6,11}$/,x={name:"Login",data:function(){return{type:"1",loginForm:{phone:(t="Blog_phone",localStorage.getItem(t)||""),password:""},registForm:{phone:"",password:"",confirmPass:""}};var t},methods:d()({},Object(C.c)(["login","regist"]),{loginOpt:function(){var t=this;return p()(l.a.mark(function e(){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("2"!==t.type){e.next=3;break}return t.type="1",e.abrupt("return");case 3:if(_.test(t.loginForm.phone)){e.next=6;break}return t.$toast({title:"请填写正确的手机号"}),e.abrupt("return");case 6:if(I.test(t.loginForm.password)){e.next=9;break}return t.$toast({title:"请填写正确的密码"}),e.abrupt("return");case 9:return n={username:t.loginForm.phone,password:f()(t.loginForm.password)},e.next=12,t.login(n);case 12:e.sent&&(t.$toast({title:"登录成功"}),h("Blog_phone",t.loginForm.phone),t.$router.replace({path:"/"}));case 14:case"end":return e.stop()}},e,t)}))()},registOpt:function(){var t=this;return p()(l.a.mark(function e(){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("1"!==t.type){e.next=3;break}return t.type="2",e.abrupt("return");case 3:if(_.test(t.registForm.phone)){e.next=6;break}return t.$toast({title:"请填写正确的手机号"}),e.abrupt("return");case 6:if(I.test(t.registForm.password)){e.next=9;break}return t.$toast({title:"请填写正确的密码"}),e.abrupt("return");case 9:if(t.registForm.confirmPass===t.registForm.password){e.next=12;break}return t.$toast({title:"请填写正确的确认密码"}),e.abrupt("return");case 12:return n={username:t.registForm.phone,password:f()(t.registForm.password),nickname:"游客"+f()(t.registForm.phone).substr(0,6),avatar:"",location:"",qq:"",wechat:"",sign:""},e.next=15,t.regist(n);case 15:e.sent&&(t.$toast({title:"注册成功"}),h("Blog_phone",t.registForm.phone),t.$router.replace({path:"/"}));case 17:case"end":return e.stop()}},e,t)}))()}})},w={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page-wrapper"},[n("div",{staticClass:"page-header"},[n("div",{staticClass:"page-header-content login-header"},[n("div",{staticClass:"common-btn back-btn",on:{click:function(e){t.$router.go(-1)}}},[t._v("返回")])])]),t._v(" "),n("div",{staticClass:"login-wrapper"},[n("div",{staticClass:"login-form"},[n("div",{staticClass:"input-wrapper"},["1"===t.type?[n("input",{directives:[{name:"model",rawName:"v-model",value:t.loginForm.phone,expression:"loginForm.phone"}],staticClass:"common-input",attrs:{type:"text",placeholder:"手机号"},domProps:{value:t.loginForm.phone},on:{input:function(e){e.target.composing||t.$set(t.loginForm,"phone",e.target.value)}}}),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.loginForm.password,expression:"loginForm.password"}],staticClass:"common-input",attrs:{type:"password",placeholder:"密码（6-10位、由字母或数字组成）"},domProps:{value:t.loginForm.password},on:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.loginOpt(e):null},input:function(e){e.target.composing||t.$set(t.loginForm,"password",e.target.value)}}})]:t._e(),t._v(" "),"2"===t.type?[n("input",{directives:[{name:"model",rawName:"v-model",value:t.registForm.phone,expression:"registForm.phone"}],staticClass:"common-input",attrs:{type:"text",placeholder:"手机号"},domProps:{value:t.registForm.phone},on:{input:function(e){e.target.composing||t.$set(t.registForm,"phone",e.target.value)}}}),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.registForm.password,expression:"registForm.password"}],staticClass:"common-input",attrs:{type:"password",placeholder:"密码（6-10位、由字母或数字组成）"},domProps:{value:t.registForm.password},on:{input:function(e){e.target.composing||t.$set(t.registForm,"password",e.target.value)}}}),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.registForm.confirmPass,expression:"registForm.confirmPass"}],staticClass:"common-input",attrs:{type:"password",placeholder:"确认密码"},domProps:{value:t.registForm.confirmPass},on:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.registOpt(e):null},input:function(e){e.target.composing||t.$set(t.registForm,"confirmPass",e.target.value)}}})]:t._e()],2),t._v(" "),n("div",{staticClass:"btn-wrapper"},[n("div",{staticClass:"btn",class:["1"===t.type?"common-btn":""],on:{click:t.loginOpt}},[t._v("登录")]),t._v(" "),n("div",{staticClass:"btn",class:["2"===t.type?"common-btn":""],on:{click:t.registOpt}},[t._v("注册")]),t._v(" "),n("a",{staticClass:"btn",attrs:{target:"_blank",href:"https://github.com/Fee-ing"}},[t._v("GitHub")])])])])])},staticRenderFns:[]};var y=n("VU/8")(x,w,!1,function(t){n("mz16")},"data-v-d6a4599c",null).exports,D={props:{userInfo:{type:Object,default:function(){return{}}},showSign:{type:Boolean,default:!1}},data:function(){return{}},methods:{viewUserOpt:function(){var t=this.userInfo.userId||"",e=this.userInfo.infoId||this.userInfo.objectId||"";t&&e&&this.$router.push({path:"/user",query:{userId:t,infoId:e}})}}},L={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"user-wrapper",on:{click:function(e){return e.stopPropagation(),t.viewUserOpt(e)}}},[t.userInfo.avatar?n("div",{staticClass:"user-avatar background-image",style:{backgroundImage:"url("+t.userInfo.avatar+")"}}):n("div",{staticClass:"user-avatar background-image user-avatar-default"}),t._v(" "),n("div",{staticClass:"user-info"},[n("div",{staticClass:"user-name"},[t._v(t._s(t.userInfo.nickname))]),t._v(" "),t.showSign&&t.userInfo.sign?n("div",{staticClass:"info-item"},[t._v(t._s(t.userInfo.sign))]):t._e(),t._v(" "),t._t("user-others")],2)])},staticRenderFns:[]};var P=n("VU/8")(D,L,!1,function(t){n("gOi+")},"data-v-8eb9ffde",null).exports,T={props:{blogData:{type:Object,default:function(){return{}}},showSign:{type:Boolean,default:!1}},data:function(){return{}},components:{userCommon:P},methods:{formatTime:k,viewOpt:function(){var t=this.blogData.objectId||"";t&&this.$router.push({path:"/blog",query:{blogid:t}})}}},B={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"blog-wrapper",on:{click:function(e){return e.stopPropagation(),t.viewOpt(e)}}},[n("div",{staticClass:"blog-header"},[n("userCommon",{staticClass:"blog-user",attrs:{userInfo:t.blogData.user,showSign:t.showSign}})],1),t._v(" "),n("div",{staticClass:"blog-body"},[t.blogData.cover?n("div",{staticClass:"blog-cover background-image",style:{backgroundImage:"url("+t.blogData.cover+")"}}):t._e(),t._v(" "),n("div",{staticClass:"blog-paragraph",domProps:{innerHTML:t._s(t.blogData.paragraph)}})]),t._v(" "),n("div",{staticClass:"blog-footer"},[n("div",{staticClass:"blog-time"},[t._v(t._s("1"===t.blogData.type?t.formatTime(t.blogData.createdAt)+"发布":t.formatTime(t.blogData.updatedAt)+"更新"))]),t._v(" "),n("div",{staticClass:"blog-info"},[n("div",{staticClass:"info-item"},[n("span",[t._v("收藏")]),t._v(t._s(t.blogData.collect||0))]),t._v(" "),n("div",{staticClass:"info-item"},[n("span",[t._v("喜欢")]),t._v(t._s(t.blogData.like||0))]),t._v(" "),n("div",{staticClass:"info-item"},[n("span",[t._v("评论")]),t._v(t._s(t.blogData.comment||0))])])])])},staticRenderFns:[]};var A=n("VU/8")(T,B,!1,function(t){n("Ak7i")},"data-v-2840f378",null).exports,$={name:"Home",data:function(){return{isLoading:!1}},components:{userCommon:P,blogCommon:A},computed:d()({},Object(C.d)({blogList:"home/blogList",isEnding:"home/isEnding",userInfo:"userInfo"})),created:function(){var t=this;return p()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.next=3,t.getData();case 3:t.isLoading=!1;case 4:case"end":return e.stop()}},e,t)}))()},mounted:function(){var t,e=this,n=this;document.querySelector(".page-wrapper").addEventListener("scroll",(t=p()(l.a.mark(function t(a){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(a.target.offsetHeight+a.target.scrollTop+100>=a.target.scrollHeight)||n.isLoading||n.isEnding){t.next=5;break}return n.isLoading=!0,t.next=4,n.getBlogList({pageDown:!0});case 4:n.isLoading=!1;case 5:case"end":return t.stop()}},t,e)})),function(e){return t.apply(this,arguments)}))},methods:d()({},Object(C.c)({logout:"logout",getUserInfo:"getUserInfo",getBlogList:"home/getBlogList"}),{getData:function(){var t=this;return p()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getBlogList();case 2:if(!t.userInfo||!t.userInfo.infoId){e.next=7;break}return e.next=5,t.getUserInfo();case 5:e.sent||t.$toast({title:"您的账号已在异地登录，请重新登录"});case 7:case"end":return e.stop()}},e,t)}))()},loginOpt:function(){this.$router.push("login")},logoutOpt:function(){this.logout(),this.$toast({title:"退出成功"})}})},S={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page-wrapper"},[n("div",{staticClass:"page-header"},[n("div",{staticClass:"page-header-content home-header"},[n("div",{staticClass:"home-header-title"},[n("span",{on:{click:t.getData}},[t._v("搭建免费博客")])]),t._v(" "),t.userInfo?[n("userCommon",{staticClass:"home-header-user",attrs:{userInfo:t.userInfo,title:"个人信息"}},[n("template",{slot:"user-others"},[n("div",{staticClass:"user-logout",attrs:{title:"退出登录"},on:{click:function(e){return e.stopPropagation(),t.logoutOpt(e)}}},[t._v("退出登录")])])],2),t._v(" "),n("div",{staticClass:"common-btn",on:{click:function(e){t.$router.push("blog")}}},[t._v("写博客")])]:n("div",{staticClass:"common-btn",on:{click:t.loginOpt}},[t._v("登录 / 注册")])],2)]),t._v(" "),n("div",{staticClass:"page-body"},[n("div",{staticClass:"page-body-content"},[t._l(t.blogList,function(t,e){return n("blogCommon",{key:e,attrs:{blogData:t,showSign:!0}})}),t._v(" "),n("div",{staticClass:"page-tip"},[t.isEnding?n("span",[t._v("没有更多啦~")]):!t.isEnding&&t.isLoading&&t.blogList.length>=10?n("span",[t._v("加载中~")]):!t.isEnding&&!t.isLoading&&t.blogList.length<=0?n("span",[t._v("这里什么也没有~")]):t._e()])],2)])])},staticRenderFns:[]};var O=n("VU/8")($,S,!1,function(t){n("m4Sm")},"data-v-181ebba5",null).exports,E=n("U7mS"),F=n.n(E),j={props:{showDelete:{type:Boolean,default:!1}},data:function(){return{colorList:[{color:"ffffff",title:"白"},{color:"0d0015",title:"漆黑"},{color:"fe2c23",title:"红"},{color:"ff9900",title:"橙"},{color:"ffd900",title:"黄"},{color:"a3e043",title:"葱绿"},{color:"37d9f0",title:"湖蓝"},{color:"4da8ee",title:"天蓝"},{color:"aa17d0",title:"紫"},{color:"f3f3f1",title:"白练"},{color:"949494",title:"鼠灰"},{color:"fcdbd6",title:"虹"},{color:"fde9d0",title:"薄卵"},{color:"fff0cf",title:"蒸栗"},{color:"d4e9d6",title:"白绿"},{color:"def3f3",title:"蓝白"},{color:"cee0ef",title:"天空"},{color:"dfdbec",title:"紫水晶"},{color:"dcdedd",title:"白鼠"},{color:"595856",title:"墨"},{color:"ee837d",title:"甚三红"},{color:"f8c387",title:"雄黄"},{color:"e6b322",title:"金色"},{color:"9abd9d",title:"薄青"},{color:"83ccd2",title:"白群"},{color:"89b0ce",title:"薄花"},{color:"9389b1",title:"紫苑"},{color:"c1c6ca",title:"灰青"},{color:"41464b",title:"石墨"},{color:"d51228",title:"绯红"},{color:"cf770b",title:"红金"},{color:"8d634a",title:"枯茶"},{color:"557b5c",title:"绿青"},{color:"01a3b0",title:"浅葱"},{color:"3776a6",title:"薄缥"},{color:"765c83",title:"紫霞"},{color:"adadad",title:"薄钝"},{color:"2b2b2b",title:"黑"},{color:"a91913",title:"朱绯"},{color:"884702",title:"褐"},{color:"563725",title:"黑茶"},{color:"00552e",title:"深绿"},{color:"00767a",title:"苍蓝"},{color:"194e77",title:"琉璃"},{color:"530e6f",title:"葡萄"}],fontsizeBol:!1,fontcolorBol:!1,backcolorBol:!1,alignBol:!1,textBol:!1,fontsizeText:"字号",fontColorText:"transparent",backColorText:"transparent",alignText:"",pic:""}},mounted:function(){var t=this;document.onclick=function(e){"link-blank"===e.target.className&&e.target.getAttribute("href")&&window.open(e.target.getAttribute("href")),t.init()}},methods:{removeClass:function(t,e){var n=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(n,"")},init:function(){this.clearStyle(),this.initStyle()},initMenuBol:function(){this.fontsizeBol=!1,this.alignBol=!1,this.backcolorBol=!1,this.fontcolorBol=!1,this.textBol=!1},initStyle:function(){this.fontsizeText="字号",this.fontColorText="transparent",this.backColorText="transparent",this.alignText="",this.initMenuBol()},clearStyle:function(){var t=this;(document.querySelectorAll(".toolbar-item")||[]).forEach(function(e){t.removeClass(e,"active")})},initBol:function(t,e){var n=this;this.clearStyle(),t.className+=" active";["fontsizeBol","alignBol","backcolorBol","fontcolorBol","textBol"].forEach(function(t){if(t===e){var a=n[e];n[e]=!a}else n[t]=!1})},getFontsize:function(t){this.initBol(t.currentTarget,"fontsizeBol")},getFontcolor:function(t){this.initBol(t.currentTarget,"fontcolorBol")},getBackcolor:function(t){this.initBol(t.currentTarget,"backcolorBol")},getAlign:function(t){this.initBol(t.currentTarget,"alignBol")},getText:function(t){this.initBol(t.currentTarget,"textBol")},execCommandOpt:function(t){this.initBol(t.currentTarget,null);var e=t.currentTarget.getAttribute("data-key");document.execCommand(e,!1,null)},createLinkOpt:function(t){this.initBol(t.currentTarget,null);var e=document.getSelection();if(""!==e.toString().replace(/(^\s*)|(\s*$)/g,"")){var n=window.prompt("请输入链接","http://");document.execCommand("insertHTML",!1,'<a class="link-blank" href="'+n+'" target="_blank">'+e+"</a>")}},fontSize:function(t,e){document.execCommand("fontSize",!1,t),this.fontsizeText=e,this.fontcolorBol=!1},fontColor:function(t){document.execCommand("ForeColor",!1,t),this.fontColorText=t,this.fontcolorBol=!1},backColor:function(t){document.execCommand("BackColor",!1,t),this.backColorText=t,this.backcolorBol=!1},alignOpt:function(t){document.execCommand(t,!1,null),this.alignText=t,this.alignBol=!1},addText:function(t){document.execCommand("formatBlock",!1,"<"+t+">"),this.textBol=!1},addImg:function(){var t=this,e=this;F()(event.currentTarget.files[0]).then(function(t){e.pic=t.base64,e.$emit("add-img",t.base64)}).catch(function(){t.$toast({title:"图片上传失败"})})},clearOpt:function(){this.$emit("clear-html")},deleteOpt:function(){window.confirm("确认删除文章？")&&this.$emit("deltet-blog")},saveOpt:function(){this.$emit("add-blog")}}},N={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"edit-header"},[n("ul",{staticClass:"editbar-list"},[n("li",{staticClass:"editbar-list-item"},[n("button",{staticClass:"toolbar-item undo",attrs:{type:"button",unselectable:"on",title:"撤销","data-key":"undo"},on:{click:function(e){return e.stopPropagation(),t.execCommandOpt(e)}}}),t._v(" "),n("button",{staticClass:"toolbar-item redo",attrs:{type:"button",unselectable:"on",title:"重做","data-key":"redo"},on:{click:function(e){return e.stopPropagation(),t.execCommandOpt(e)}}}),t._v(" "),n("button",{staticClass:"toolbar-item clear-format",attrs:{type:"button",unselectable:"on",title:"清除格式","data-key":"removeFormat"},on:{click:function(e){return e.stopPropagation(),t.execCommandOpt(e)}}})]),t._v(" "),n("li",{staticClass:"separator editbar-list-item"}),t._v(" "),n("li",{staticClass:"editbar-list-item"},[n("ul",{directives:[{name:"show",rawName:"v-show",value:t.fontsizeBol,expression:"fontsizeBol"}],staticClass:"toolbar-menu toolbar-menu-list toolbar-text-list"},[n("li",{staticClass:"menu-list-item"},[n("button",{attrs:{type:"button",unselectable:"on",title:"10px"},on:{click:function(e){e.stopPropagation(),t.fontSize("1","10px")}}},[t._v("10px")])]),t._v(" "),n("li",{staticClass:"menu-list-item"},[n("button",{attrs:{type:"button",unselectable:"on",title:"13px"},on:{click:function(e){e.stopPropagation(),t.fontSize("2","13px")}}},[t._v("13px")])]),t._v(" "),n("li",{staticClass:"menu-list-item"},[n("button",{attrs:{type:"button",unselectable:"on",title:"16px"},on:{click:function(e){e.stopPropagation(),t.fontSize("3","16px")}}},[t._v("16px")])]),t._v(" "),n("li",{staticClass:"menu-list-item"},[n("button",{attrs:{type:"button",unselectable:"on",title:"18px"},on:{click:function(e){e.stopPropagation(),t.fontSize("4","18px")}}},[t._v("18px")])]),t._v(" "),n("li",{staticClass:"menu-list-item"},[n("button",{attrs:{type:"button",unselectable:"on",title:"24px"},on:{click:function(e){e.stopPropagation(),t.fontSize("5","24px")}}},[t._v("24px")])]),t._v(" "),n("li",{staticClass:"menu-list-item"},[n("button",{attrs:{type:"button",unselectable:"on",title:"32px"},on:{click:function(e){e.stopPropagation(),t.fontSize("6","32px")}}},[t._v("32px")])]),t._v(" "),n("li",{staticClass:"menu-list-item"},[n("button",{attrs:{type:"button",unselectable:"on",title:"48px"},on:{click:function(e){e.stopPropagation(),t.fontSize("7","48px")}}},[t._v("48px")])])]),t._v(" "),t.fontcolorBol?n("ul",{staticClass:"toolbar-menu toolbar-color-list"},t._l(t.colorList,function(e,a){return n("li",{key:a,staticClass:"color-list-item"},[n("button",{style:{backgroundColor:"#"+e.color},attrs:{type:"button",unselectable:"on",title:e.title},on:{click:function(n){n.stopPropagation(),t.fontColor("#"+e.color)}}})])})):t._e(),t._v(" "),t.backcolorBol?n("ul",{staticClass:"toolbar-menu toolbar-color-list toolbar-color-list1"},t._l(t.colorList,function(e,a){return n("li",{key:a,staticClass:"color-list-item"},[n("button",{style:{backgroundColor:"#"+e.color},attrs:{type:"button",unselectable:"on",title:e.title},on:{click:function(n){n.stopPropagation(),t.backColor("#"+e.color)}}})])})):t._e(),t._v(" "),t.alignBol?n("ul",{staticClass:"toolbar-menu toolbar-menu-list toolbar-align-list"},[n("li",{staticClass:"menu-list-item"},[n("button",{attrs:{type:"button",unselectable:"on",title:"左对齐"},on:{click:function(e){e.stopPropagation(),t.alignOpt("justifyLeft")}}},[n("span",{staticClass:"menu-list-left"})])]),t._v(" "),n("li",{staticClass:"menu-list-item"},[n("button",{attrs:{type:"button",unselectable:"on",title:"居中"},on:{click:function(e){e.stopPropagation(),t.alignOpt("justifyCenter")}}},[n("span",{staticClass:"menu-list-center"})])]),t._v(" "),n("li",{staticClass:"menu-list-item"},[n("button",{attrs:{type:"button",unselectable:"on",title:"右对齐"},on:{click:function(e){e.stopPropagation(),t.alignOpt("justifyRight")}}},[n("span",{staticClass:"menu-list-right"})])]),t._v(" "),n("li",{staticClass:"menu-list-item"},[n("button",{attrs:{type:"button",unselectable:"on",title:"两端对齐"},on:{click:function(e){e.stopPropagation(),t.alignOpt("justifyFull")}}},[n("span",{staticClass:"menu-list-justify"})])])]):t._e(),t._v(" "),n("button",{staticClass:"toolbar-item toolbar-item-select font",attrs:{type:"button",unselectable:"on",title:"文字"},on:{click:function(e){return e.stopPropagation(),t.getFontsize(e)}}},[t._v("\n        "+t._s(t.fontsizeText)+"\n        "),n("span",{staticClass:"new-icon-down"})]),t._v(" "),n("button",{staticClass:"toolbar-item bold",attrs:{type:"button",unselectable:"on",title:"粗体","data-key":"bold"},on:{click:function(e){return e.stopPropagation(),t.execCommandOpt(e)}}}),t._v(" "),n("button",{staticClass:"toolbar-item italic",attrs:{type:"button",unselectable:"on",title:"斜体","data-key":"italic"},on:{click:function(e){return e.stopPropagation(),t.execCommandOpt(e)}}}),t._v(" "),n("button",{staticClass:"toolbar-item underline",attrs:{type:"button",unselectable:"on",title:"下划线","data-key":"underline"},on:{click:function(e){return e.stopPropagation(),t.execCommandOpt(e)}}}),t._v(" "),n("button",{staticClass:"toolbar-item strikethrough",attrs:{type:"button",unselectable:"on",title:"中划线","data-key":"strikethrough"},on:{click:function(e){return e.stopPropagation(),t.execCommandOpt(e)}}}),t._v(" "),n("button",{staticClass:"toolbar-item link",attrs:{type:"button",unselectable:"on",title:"超链接","data-key":"createLink"},on:{click:function(e){return e.stopPropagation(),t.createLinkOpt(e)}}}),t._v(" "),n("button",{staticClass:"toolbar-item toolbar-item-select fontcolor",attrs:{type:"button",unselectable:"on",title:"字体颜色"},on:{click:function(e){return e.stopPropagation(),t.getFontcolor(e)}}},[n("span",{staticClass:"new-icon-down"}),t._v(" "),n("span",{staticClass:"line",style:{backgroundColor:t.fontColorText}})]),t._v(" "),n("button",{staticClass:"toolbar-item toolbar-item-select backcolor",attrs:{type:"button",unselectable:"on",title:"背景颜色"},on:{click:function(e){return e.stopPropagation(),t.getBackcolor(e)}}},[n("span",{staticClass:"new-icon-down"}),t._v(" "),n("span",{staticClass:"line",style:{backgroundColor:t.backColorText}})]),t._v(" "),n("button",{staticClass:"toolbar-item toolbar-item-select align-toolbar",class:t.alignText,attrs:{type:"button",unselectable:"on",title:"对齐"},on:{click:function(e){return e.stopPropagation(),t.getAlign(e)}}},[n("span",{staticClass:"new-icon-down"})])]),t._v(" "),n("li",{staticClass:"separator editbar-list-item"}),t._v(" "),n("li",{staticClass:"editbar-list-item"},[t.textBol?n("ul",{staticClass:"toolbar-menu toolbar-menu-list toolbar-text-list"},[n("li",{staticClass:"menu-list-item"},[n("button",{attrs:{type:"button",unselectable:"on",title:"段落"},on:{click:function(e){e.stopPropagation(),t.addText("p")}}},[t._v("段落")])]),t._v(" "),n("li",{staticClass:"menu-list-item"},[n("button",{attrs:{type:"button",unselectable:"on",title:"大标题"},on:{click:function(e){e.stopPropagation(),t.addText("h1")}}},[t._v("大标题")])]),t._v(" "),n("li",{staticClass:"menu-list-item"},[n("button",{attrs:{type:"button",unselectable:"on",title:"中标题"},on:{click:function(e){e.stopPropagation(),t.addText("h2")}}},[t._v("中标题")])]),t._v(" "),n("li",{staticClass:"menu-list-item"},[n("button",{attrs:{type:"button",unselectable:"on",title:"小标题"},on:{click:function(e){e.stopPropagation(),t.addText("h3")}}},[t._v("小标题")])])]):t._e(),t._v(" "),n("button",{staticClass:"toolbar-item toolbar-item-select font",attrs:{type:"button",unselectable:"on",title:"文字"},on:{click:function(e){return e.stopPropagation(),t.getText(e)}}},[t._v("文字"),n("span",{staticClass:"new-icon-down"})]),t._v(" "),n("button",{staticClass:"toolbar-item image",attrs:{type:"button",unselectable:"on",title:"图片"}},[n("input",{staticClass:"image-input",attrs:{type:"file",accept:"*.png,*.jpg,*.jpeg,*gif",unselectable:"on"},on:{change:function(e){return e.stopPropagation(),t.addImg(e)}}})]),t._v(" "),n("button",{staticClass:"toolbar-item button edit-button",attrs:{type:"button",unselectable:"on",title:"清空内容"},on:{click:function(e){return e.stopPropagation(),t.clearOpt(e)}}},[t._v("清空内容")]),t._v(" "),t.showDelete?n("button",{staticClass:"toolbar-item button edit-button",attrs:{type:"button",unselectable:"on",title:"删除文章"},on:{click:function(e){return e.stopPropagation(),t.deleteOpt(e)}}},[t._v("删除")]):t._e(),t._v(" "),n("button",{staticClass:"toolbar-item button edit-button",attrs:{type:"button",unselectable:"on",title:"保存"},on:{click:function(e){return e.stopPropagation(),t.saveOpt(e)}}},[t._v("保存")])])])])},staticRenderFns:[]};var q=n("VU/8")(j,N,!1,function(t){n("gnv+")},"data-v-01d4a58e",null).exports,U=Object(C.a)("blog"),z=U.mapGetters,H=U.mapActions,M={data:function(){return{contentWrapper:null,type:"1",commentContent:"",isLoading:!1}},components:{editHeader:q,userCommon:P},created:function(){var t=this;return p()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.$route.query.blogid?t.type="2":t.type="1",e.next=3,t.getBlog({type:t.type,blogid:t.$route.query.blogid||""});case 3:case"end":return e.stop()}},e,t)}))()},mounted:function(){var t=this;this.contentWrapper=document.getElementById("content-wrapper"),this.$route.query.blogid||this.contentWrapper.focus();var e=this;this.$nextTick(function(){var n;document.querySelector(".editor-wrapper").addEventListener("scroll",(n=p()(l.a.mark(function n(a){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!("2"===e.type&&a.target.offsetHeight+a.target.scrollTop+100>=a.target.scrollHeight)||e.isLoading||e.commentData.isEnding){t.next=5;break}return e.isLoading=!0,t.next=4,e.viewCommons({pageDown:!0});case 4:e.isLoading=!1;case 5:case"end":return t.stop()}},n,t)})),function(t){return n.apply(this,arguments)}))})},computed:d()({},z(["userInfo","blogData","isAuthor","likeData","collectData","commentData"])),methods:d()({},H(["getBlog","createBlog","updateBlog","deleteBlog","likeBlog","unlikeBlog","viewCommons","commentBlog","uncollectBlog","collectBlog"]),{formatTime:k,insertHtmlAtCaret:function(t){var e=void 0,n=void 0;if(window.getSelection){if((e=window.getSelection()).getRangeAt&&e.rangeCount){(n=e.getRangeAt(0)).deleteContents();var a=document.createElement("div");a.innerHTML=t;for(var s=document.createDocumentFragment(),o=void 0,r=void 0;o=a.firstChild;)r=s.appendChild(o);n.insertNode(s),r&&((n=n.cloneRange()).setStartAfter(r),n.collapse(!0),e.removeAllRanges(),e.addRange(n))}}else document.selection&&"Control"!==document.selection.type&&document.selection.createRange().pasteHTML(t)},getBlogInfo:function(t){var e=[],n=/src=['"]?([^'"]*)['"]?/i,a=t.replace(/<[^>]+>/gim,"");a.length>150&&(a=a.substr(0,150)+'...<span class="blog-more">查看更多</span>');var s=t.match(/<img.*?(?:>|\/>)/gi);return s?(s.forEach(function(t){var a=t.match(n);a[1]&&e.push(a[1])}),{cover:e[0],paragraph:a}):{cover:"",paragraph:a}},addImg:function(t){this.contentWrapper.focus();var e='<img src="'+t+'">';this.insertHtmlAtCaret(e)},clearOpt:function(){this.contentWrapper.innerHTML="",this.contentWrapper.focus()},deleteOpt:function(){var t=this;return p()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.deleteBlog();case 2:e.sent&&(t.$toast({title:"删除成功"}),t.$router.go(-1));case 4:case"end":return e.stop()}},e,t)}))()},submitOpt:function(){var t=this;return p()(l.a.mark(function e(){var n,a,s;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==t.contentWrapper.innerHTML.replace(/(^\s*)|(\s*$)/,"")){e.next=2;break}return e.abrupt("return");case 2:if(n=t.contentWrapper.innerHTML.replace(/(^\s*)|(\s*$)/,"").replace(/<script[^>]*>[\s\S]*?<\/[^>]*script>/gi,""),a=t.getBlogInfo(n),s={params1:{cover:a.cover,paragraph:a.paragraph},params2:{content:n}},"1"!==t.type){e.next=12;break}return e.next=8,t.createBlog(s);case 8:e.sent&&(t.$toast({title:"发布成功"}),t.$router.go(-1)),e.next=17;break;case 12:if("2"!==t.type||!t.$route.query.blogid||t.userInfo.objectId!==t.blogData.userid){e.next=17;break}return e.next=15,t.updateBlog(s);case 15:e.sent&&(t.$toast({title:"更新成功"}),t.$router.go(-1));case 17:case"end":return e.stop()}},e,t)}))()},likeOpt:function(){this.userInfo?this.likeData.isLiked?this.unlikeBlog():this.likeBlog():this.$toast({title:"请先登录"})},collectOpt:function(){this.userInfo?this.collectData.isCollected?this.uncollectBlog():this.collectBlog():this.$toast({title:"请先登录"})},commentOpt:function(){var t=this;return p()(l.a.mark(function e(){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.userInfo){e.next=3;break}return t.$toast({title:"请先登录"}),e.abrupt("return");case 3:if(""!==(n=t.commentContent.replace(/(^\s*)|(\s*$)/,""))){e.next=6;break}return e.abrupt("return");case 6:if(!(n.length>100)){e.next=9;break}return t.$toast({title:"评论不超过100字"}),e.abrupt("return");case 9:return e.next=11,t.commentBlog({comment:n});case 11:e.sent&&(t.commentContent="");case 13:case"end":return e.stop()}},e,t)}))()}})},X={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page-wrapper editor-wrapper"},[n("div",{staticClass:"page-header"},[n("div",{staticClass:"common-btn back-btn",on:{click:function(e){t.$router.go(-1)}}},[t._v("返回")]),t._v(" "),n("div",{staticClass:"page-header-content"},[t.isAuthor?n("edit-header",{attrs:{showDelete:"2"===t.type&&t.isAuthor},on:{"add-img":t.addImg,"clear-html":t.clearOpt,"deltet-blog":t.deleteOpt,"add-blog":t.submitOpt}}):n("div",{staticClass:"page-header-title"},[t._v(t._s(t.blogData.user&&t.blogData.user.nickname)+"的博客")])],1)]),t._v(" "),n("div",{staticClass:"page-body"},[n("div",{staticClass:"page-body-content"},["1"===t.type?n("userCommon",{attrs:{userInfo:t.userInfo}},[n("template",{slot:"user-others"},[n("div",{staticClass:"info-item"},[t._v("作者")])])],2):n("userCommon",{attrs:{userInfo:t.blogData.user}},[n("template",{slot:"user-others"},[n("div",{staticClass:"info-item"},[t._v("作者")])])],2),t._v(" "),n("div",{staticClass:"content-wrapper",attrs:{id:"content-wrapper",contenteditable:t.isAuthor},domProps:{innerHTML:t._s(t.blogData.content)}}),t._v(" "),"2"===t.type?n("div",{staticClass:"blog-info"},[n("div",{staticClass:"blog-options"},[n("div",{staticClass:"blog-time"},[t._v(t._s("1"===t.blogData.type?t.formatTime(t.blogData.createdAt)+"发布":t.formatTime(t.blogData.updatedAt)+"更新"))]),t._v(" "),n("div",{staticClass:"favor-btn common-btn",on:{click:t.likeOpt}},[t._v(t._s(t.likeData.isLiked?"已":"")+"喜欢")]),t._v(" "),t.userInfo&&t.isAuthor?t._e():n("div",{staticClass:"favor-btn common-btn",on:{click:t.collectOpt}},[t._v(t._s(t.collectData.isCollected?"已":"")+"收藏")])]),t._v(" "),t.likeData.list.length>0?n("div",{staticClass:"blog-likes blog-common"},[n("div",{staticClass:"title"},[t._v("喜欢（"+t._s(t.likeData.list.length)+"人）：")]),t._v(" "),n("div",{staticClass:"likes-conent"},t._l(t.likeData.list,function(t,e){return n("div",{key:e,staticClass:"likes-item"},[n("div",{staticClass:"likes-info"},[n("userCommon",{staticClass:"small-avatar",attrs:{userInfo:t.user}})],1)])}))]):t._e(),t._v(" "),t.collectData.list.length>0?n("div",{staticClass:"blog-likes blog-common"},[n("div",{staticClass:"title"},[t._v("收藏（"+t._s(t.collectData.list.length)+"人）：")]),t._v(" "),n("div",{staticClass:"likes-conent"},t._l(t.collectData.list,function(t,e){return n("div",{key:e,staticClass:"likes-item"},[n("div",{staticClass:"likes-info"},[n("userCommon",{staticClass:"small-avatar",attrs:{userInfo:t.user}})],1)])}))]):t._e(),t._v(" "),n("div",{staticClass:"blog-comments blog-common"},[n("div",{staticClass:"title"},[t._v("评论（"+t._s(t.commentData.total)+"条）：")]),t._v(" "),n("div",{staticClass:"comments-content"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.commentContent,expression:"commentContent"}],staticClass:"comments-input",attrs:{cols:"30",rows:"3",placeholder:"不超过100字"},domProps:{value:t.commentContent},on:{input:function(e){e.target.composing||(t.commentContent=e.target.value)}}}),t._v(" "),n("div",{staticClass:"comments-options"},[n("div",{staticClass:"comments-tips"}),t._v(" "),n("div",{staticClass:"comments-btn common-btn",on:{click:t.commentOpt}},[t._v("提交评论")])]),t._v(" "),n("div",{staticClass:"comments-list"},t._l(t.commentData.list,function(e,a){return n("div",{key:a,staticClass:"comments-item"},[n("div",{staticClass:"comments-user"},[n("userCommon",{staticClass:"small-avatar",attrs:{userInfo:e.user}}),t._v(" "),n("div",{staticClass:"comments-time"},[t._v(t._s(t.formatTime(e.createdAt)))])],1),t._v(" "),n("div",{staticClass:"comments-detail"},[t._v(t._s(e.comment))])])}))])])]):t._e(),t._v(" "),n("div",{staticClass:"page-tip"},[t.commentData.isEnding?n("span",[t._v("没有更多评论啦~")]):!t.commentData.isEnding&&t.isLoading&&t.commentData.total>=15?n("span",[t._v("加载中~")]):t._e()])],1)])])},staticRenderFns:[]};var R=n("VU/8")(M,X,!1,function(t){n("OeVF")},"data-v-722cd5f2",null).exports,W=Object(C.a)("user"),G=W.mapGetters,V=W.mapActions,Q={data:function(){return{type:"1",blogType:"1",isLoading:!1}},components:{blogCommon:A},computed:d()({},G(["userInfo","isAuthor","userData","blogList","isEnding"])),watch:{$route:function(){this.getData()}},created:function(){this.getData()},mounted:function(){var t,e=this,n=this;document.querySelector(".page-wrapper").addEventListener("scroll",(t=p()(l.a.mark(function t(a){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(a.target.offsetHeight+a.target.scrollTop+100>=a.target.scrollHeight)||n.isLoading||n.isEnding){t.next=5;break}return n.isLoading=!0,t.next=4,n.viewBlog({userId:n.$route.query.userId,blogType:n.blogType,pageDown:!0});case 4:n.isLoading=!1;case 5:case"end":return t.stop()}},t,e)})),function(e){return t.apply(this,arguments)}))},methods:d()({},V(["getUser","viewBlog","updateUser"]),{formatTime:k,getData:function(){var t=this;return p()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.type="1",t.blogType="1",t.isLoading=!0,e.next=5,t.getUser({userId:t.$route.query.userId});case 5:return e.next=7,t.viewBlog({infoId:t.$route.query.infoId,blogType:t.blogType});case 7:t.isLoading=!1;case 8:case"end":return e.stop()}},e,t)}))()},editOpt:function(){this.type="2"},updateAvatar:function(){var t=this;F()(event.currentTarget.files[0]).then(function(e){t.userData.avatar=e.base64}).catch(function(){t.$toast("图片上传失败")})},saveOpt:function(){var t=this;return p()(l.a.mark(function e(){var n,a,s,o;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n={avatar:t.userData.avatar||"",nickname:(t.userData.nickname||"").replace(/\s/gi,""),location:(t.userData.location||"").replace(/\s/gi,""),qq:(t.userData.qq||"").replace(/\s/gi,""),wechat:(t.userData.wechat||"").replace(/\s/gi,""),sign:(t.userData.sign||"").replace(/\s/gi,"")},a=/^[\u3002|\uff1f|\uff01|\uff0c|\u3001|\uff1b|\uff1a|\u201c|\u201d|\u2018|\u2019|\uff08|\uff09|\u300a|\u300b|\u3008|\u3009|\u3010|\u3011|\u300e|\u300f|\u300c|\u300d|\ufe43|\ufe44|\u3014|\u3015|\u2026|\u2014|\uff5e|\ufe4f|\uffe5\u4e00-\u9fa5\w]{0,30}$/,/^[\u4e00-\u9fa5a-z0-9]{1,8}$/i.test(n.nickname)){e.next=5;break}return t.$toast({title:"请填写正确的昵称"}),e.abrupt("return");case 5:if(!n.location||/^[\u4e00-\u9fa5a-z0-9]{0,10}$/.test(n.location)){e.next=8;break}return t.$toast({title:"请填写正确的地址"}),e.abrupt("return");case 8:if(!n.qq||/^\d{7,12}$/.test(n.qq)){e.next=11;break}return t.$toast({title:"请填写正确的QQ号"}),e.abrupt("return");case 11:if(!n.wechat||/^[a-z0-9]+$/i.test(n.wechat)){e.next=14;break}return t.$toast({title:"请填写正确的微信"}),e.abrupt("return");case 14:if(!n.sign||a.test(n.sign)){e.next=17;break}return t.$toast({title:"请填写正确的签名"}),e.abrupt("return");case 17:s=!0,e.t0=l.a.keys(n);case 19:if((e.t1=e.t0()).done){e.next=28;break}if(o=e.t1.value,!n.hasOwnProperty(o)){e.next=26;break}if(n[o]===t.userInfo[o]){e.next=26;break}return s=!1,e.abrupt("break",28);case 26:e.next=19;break;case 28:if(!s){e.next=31;break}return t.type="1",e.abrupt("return");case 31:return e.next=33,t.updateUser(n);case 33:return e.sent&&(t.type="1",t.$toast({title:"保存成功"})),e.next=37,t.viewBlog({infoId:t.$route.query.infoId,blogType:t.blogType});case 37:case"end":return e.stop()}},e,t)}))()},changeBolgType:function(t){var e=this;return p()(l.a.mark(function n(){return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e.isLoading=!0,e.blogType=t,n.next=4,e.viewBlog({infoId:e.$route.query.infoId,blogType:e.blogType});case 4:e.isLoading=!1;case 5:case"end":return n.stop()}},n,e)}))()}})},Y={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page-wrapper user-wrapper"},[n("div",{staticClass:"page-header"},[n("div",{staticClass:"common-btn back-btn",on:{click:function(e){t.$router.go(-1)}}},[t._v("返回")]),t._v(" "),n("div",{staticClass:"page-header-content"},[n("div",{staticClass:"page-header-title"},[t._v(t._s(t.isAuthor?"我":t.userData.nickname)+"的主页")])])]),t._v(" "),n("div",{staticClass:"page-body"},[n("div",{staticClass:"page-body-content"},[n("div",{staticClass:"user-header"},[n("div",{staticClass:"left"},[n("div",{staticClass:"left-avatar"},[t.userData.avatar?n("div",{staticClass:"avatar background-image",style:{backgroundImage:"url("+t.userData.avatar+")"}}):n("div",{staticClass:"avatar background-image avatar-default"}),t._v(" "),"2"===t.type?n("input",{staticClass:"avatar-input",attrs:{type:"file",accept:"*.png,*.jpg,*.jpeg,*gif"},on:{change:function(e){return e.stopPropagation(),t.updateAvatar(e)}}}):t._e(),t._v(" "),"2"===t.type?n("div",{staticClass:"tip"},[t._v("更换头像")]):t._e()]),t._v(" "),n("div",{staticClass:"name"},["1"===t.type?n("span",[t._v(t._s(t.userData.nickname))]):n("input",{directives:[{name:"model",rawName:"v-model",value:t.userData.nickname,expression:"userData.nickname"}],attrs:{type:"text",placeholder:"8字以内"},domProps:{value:t.userData.nickname},on:{input:function(e){e.target.composing||t.$set(t.userData,"nickname",e.target.value)}}})]),t._v(" "),t.isAuthor?n("div",{staticClass:"btn-wrapper"},["1"===t.type?n("div",{staticClass:"btn common-btn",on:{click:t.editOpt}},[t._v("编辑")]):n("div",{staticClass:"btn common-btn",on:{click:t.saveOpt}},[t._v("保存")])]):t._e()]),t._v(" "),n("div",{staticClass:"right"},[t.isAuthor&&t.userData.username?n("div",{staticClass:"right-item"},[n("span",{staticClass:"right-title"},[t._v("账号：")]),t._v(" "),n("div",{staticClass:"right-content"},[n("span",[t._v(t._s(t.userData.username))])])]):t._e(),t._v(" "),n("div",{staticClass:"right-item"},[n("span",{staticClass:"right-title"},[t._v("地址：")]),t._v(" "),n("div",{staticClass:"right-content"},["1"===t.type?n("span",[t._v(t._s(t.userData.location||"未设置"))]):n("input",{directives:[{name:"model",rawName:"v-model",value:t.userData.location,expression:"userData.location"}],attrs:{type:"text",placeholder:"选填，不超过10个字"},domProps:{value:t.userData.location},on:{input:function(e){e.target.composing||t.$set(t.userData,"location",e.target.value)}}})])]),t._v(" "),n("div",{staticClass:"right-item"},[n("span",{staticClass:"right-title"},[t._v("QQ：")]),t._v(" "),n("div",{staticClass:"right-content"},["1"===t.type?n("span",[t._v(t._s(t.userData.qq||"未设置"))]):n("input",{directives:[{name:"model",rawName:"v-model",value:t.userData.qq,expression:"userData.qq"}],attrs:{type:"text",placeholder:"选填"},domProps:{value:t.userData.qq},on:{input:function(e){e.target.composing||t.$set(t.userData,"qq",e.target.value)}}})])]),t._v(" "),n("div",{staticClass:"right-item"},[n("span",{staticClass:"right-title"},[t._v("微信：")]),t._v(" "),n("div",{staticClass:"right-content"},["1"===t.type?n("span",[t._v(t._s(t.userData.wechat||"未设置"))]):n("input",{directives:[{name:"model",rawName:"v-model",value:t.userData.wechat,expression:"userData.wechat"}],attrs:{type:"text",placeholder:"选填"},domProps:{value:t.userData.wechat},on:{input:function(e){e.target.composing||t.$set(t.userData,"wechat",e.target.value)}}})])]),t._v(" "),n("div",{staticClass:"right-item"},[n("span",{staticClass:"right-title"},[t._v("签名：")]),t._v(" "),n("div",{staticClass:"right-content"},["1"===t.type?n("span",[t._v(t._s(t.userData.sign||"未设置"))]):n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.userData.sign,expression:"userData.sign"}],attrs:{cols:"30",rows:"2",placeholder:"选填，不超过30个字"},domProps:{value:t.userData.sign},on:{input:function(e){e.target.composing||t.$set(t.userData,"sign",e.target.value)}}})])])])]),t._v(" "),n("div",{staticClass:"user-body"},[n("div",{staticClass:"user-body-header"},[n("div",{staticClass:"btn-wrapper"},[n("div",{staticClass:"common-btn",class:["1"===t.blogType?"active":""],on:{click:function(e){t.changeBolgType("1")}}},[t._v(t._s(t.isAuthor?"我":"他")+"发布的")]),t._v(" "),n("div",{staticClass:"common-btn",class:["2"===t.blogType?"active":""],on:{click:function(e){t.changeBolgType("2")}}},[t._v(t._s(t.isAuthor?"我":"他")+"收藏的")]),t._v(" "),n("div",{staticClass:"common-btn",class:["3"===t.blogType?"active":""],on:{click:function(e){t.changeBolgType("3")}}},[t._v(t._s(t.isAuthor?"我":"他")+"喜欢的")])]),t._v(" "),n("div",{staticClass:"info-wrapper"},[t._v(t._s(t.formatTime(t.userData.createdAt,"2"))+" 注册")])]),t._v(" "),t._l(t.blogList,function(t,e){return n("blogCommon",{key:e,attrs:{blogData:t,showSign:!0}})})],2),t._v(" "),n("div",{staticClass:"page-tip"},[t.isEnding?n("span",[t._v("没有更多啦~")]):!t.isEnding&&t.isLoading&&t.blogList.length>=10?n("span",[t._v("加载中~")]):!t.isEnding&&!t.isLoading&&t.blogList.length<=0?n("span",[t._v("这里什么也没有~")]):t._e()])])])])},staticRenderFns:[]};var J=n("VU/8")(Q,Y,!1,function(t){n("4UON")},"data-v-116f2706",null).exports;s.a.use(i.a);var K=new i.a({routes:[{path:"/login",name:"login",component:y},{path:"/",name:"home",component:O},{path:"/blog",name:"blog",component:R},{path:"/user",name:"user",component:J}]}),Z=function(t){return t.userInfo},tt=n("woOf"),et=n.n(tt),nt="https://api.leancloud.cn",at={baseAPI:nt,loginAPI:nt+"/1.1/login",userAPI:nt+"/1.1/users",userInfoAPI:nt+"/1.1/classes/userInfo",blogListAPI:nt+"/1.1/classes/blogList",blogsAPI:nt+"/1.1/classes/blogs",collectsAPI:nt+"/1.1/classes/collects",likesAPI:nt+"/1.1/classes/likes",commentsAPI:nt+"/1.1/classes/comments"},st="gytm4jB6IQzdW0i28v8UAY4H-gzGzoHsz",ot="WnCTEGn77xqkv2IM7nml1Ts0",rt=n("//Fk"),it=n.n(rt),ct=n("Y81h"),lt=n.n(ct),ut=n("mtWM"),pt=n.n(ut),mt=(new Date).getTime(),dt=pt.a.create({baseURL:at.baseAPI,headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json","X-LC-Id":st,"X-LC-Sign":f()(mt.toString()+ot)+","+mt},timeout:5e3}),gt={};["get","post","put","delete"].forEach(function(t){gt[t]=function(e,n,a){return new it.a(function(s,o){lt.a.start(),dt[t](e,n,a).then(function(t){lt.a.done(),t.status>=200&&t.status<300?s(t.data):(v({title:"请求错误"}),o(t))}).catch(function(t){lt.a.done(),v({title:t.response&&t.response.data&&t.response.data.error||"请求错误"}),o(t)})})}});var ft=gt,vt={regist:function(t,e){var n=this,a=t.commit;return p()(l.a.mark(function t(){var s,o,r;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,s={nickname:e.nickname,avatar:""},t.next=4,ft.post(at.userAPI,e);case 4:return o=t.sent,s.userId=o.objectId||"",s.sessionToken=o.sessionToken||"",t.next=9,ft.post(at.userInfoAPI,et()({userId:s.userId},s));case 9:return r=t.sent,s.infoId=r.objectId||"",a("setUserInfo",s),t.abrupt("return",!0);case 15:return t.prev=15,t.t0=t.catch(0),t.abrupt("return",!1);case 18:case"end":return t.stop()}},t,n,[[0,15]])}))()},login:function(t,e){var n=this,a=t.dispatch;return p()(l.a.mark(function t(){var s,o,r;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ft.post(at.loginAPI,e);case 3:return s=t.sent,o={userId:s.objectId||"",sessionToken:s.sessionToken||"",nickname:s.nickname,avatar:s.avatar||""},t.next=7,ft.get(at.userInfoAPI,{params:{where:{userId:o.userId}}});case 7:return r=t.sent,o.infoId=r.results[0].objectId||"",a("updateUserToken",o),t.abrupt("return",!0);case 13:return t.prev=13,t.t0=t.catch(0),t.abrupt("return",!1);case 16:case"end":return t.stop()}},t,n,[[0,13]])}))()},updateUserToken:function(t,e){var n=this,a=t.commit;return p()(l.a.mark(function t(){var s;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,s={token:f()((new Date).getTime())},t.next=4,ft.put(at.userInfoAPI+"/"+e.infoId,s,{headers:{"X-LC-Session":e.sessionToken}});case 4:return a("setUserInfo",et()(e,s)),t.abrupt("return",!0);case 8:return t.prev=8,t.t0=t.catch(0),t.abrupt("return",!1);case 11:case"end":return t.stop()}},t,n,[[0,8]])}))()},logout:function(t){(0,t.commit)("clearUserInfo")},getUserInfo:function(t){var e=this,n=t.state,a=t.commit;return p()(l.a.mark(function t(){var s;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ft.get(at.userInfoAPI+"/"+n.userInfo.infoId,{params:{keys:"nickname,avatar,token"}});case 3:if(!(s=t.sent)||!s.token||s.token!==n.userInfo.token){t.next=9;break}return a("setUserInfo",{nickname:s.nickname,avatar:s.avatar,token:s.token}),t.abrupt("return",!0);case 9:return a("clearUserInfo"),t.abrupt("return",!1);case 11:t.next=17;break;case 13:return t.prev=13,t.t0=t.catch(0),a("clearUserInfo"),t.abrupt("return",!1);case 17:case"end":return t.stop()}},t,e,[[0,13]])}))()}},bt=n("mvHQ"),ht=n.n(bt),kt={setUserInfo:function(t,e){var n=t.userInfo?JSON.parse(ht()(t.userInfo)):{};t.userInfo=et()(n,e);var a={userId:t.userInfo.userId,sessionToken:t.userInfo.sessionToken,infoId:t.userInfo.infoId,token:t.userInfo.token||""};!function(t,e,n){n||(n=1);var a=new Date;a.setTime(a.getTime()+24*n*60*60*1e3),document.cookie=t+"="+escape(e)+";expires="+a.toGMTString()}("Blog_userInfo",ht()(a))},clearUserInfo:function(t){t.userInfo=null,function(t){var e=new Date;e.setTime(e.getTime()-1);var n=b(t);n&&(document.cookie=t+"="+n+";expires="+e.toGMTString())}("Blog_userInfo")}},Ct={namespaced:!0,state:{page:1,per:10,total:1,isEnding:!1,blogList:[]},getters:{blogList:function(t){return t.blogList},isEnding:function(t){return t.isEnding}},actions:{getBlogList:function(t,e){var n=this,a=t.commit,s=t.state;t.rootState;return p()(l.a.mark(function t(){var o,r;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,o={params:{order:"-createdAt",limit:s.per,skip:0,count:1,include:"user"}},!e||!e.pageDown){t.next=11;break}if(o.params.limit=(s.page+1)*s.per,o.params.skip=s.page*s.per,!(s.total<=o.params.skip)){t.next=8;break}return a("setIsEnding",!0),t.abrupt("return",!0);case 8:a("setPage",s.page+1),t.next=13;break;case 11:a("setIsEnding",!1),a("setPage",1);case 13:return t.next=15,ft.get(at.blogListAPI,o);case 15:return(r=t.sent)&&r.results&&(a("setTotal",r.count||1),e&&e.pageDown?a("setBlogList",s.blogList.concat(r.results)):a("setBlogList",r.results)),t.abrupt("return",!0);case 20:return t.prev=20,t.t0=t.catch(0),t.abrupt("return",!1);case 23:case"end":return t.stop()}},t,n,[[0,20]])}))()}},mutations:{setPage:function(t,e){t.page=e},setTotal:function(t,e){t.total=e},setIsEnding:function(t,e){t.isEnding=e},setBlogList:function(t,e){t.blogList=e}}},_t={namespaced:!0,state:{blogData:{},isAuthor:!1,collectData:{list:[],isCollected:!1},likeData:{list:[],isLiked:!1},commentData:{page:1,per:15,total:1,isEnding:!1,list:[]}},getters:{userInfo:function(t,e,n){return n.userInfo},blogData:function(t){return t.blogData},isAuthor:function(t){return t.isAuthor},collectData:function(t){return t.collectData},likeData:function(t){return t.likeData},commentData:function(t){return t.commentData}},actions:{getBlog:function(t,e){var n=this,a=t.dispatch,s=t.commit,o=t.rootState;return p()(l.a.mark(function t(){var r,i,c;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,s("initData"),"1"!==e.type){t.next=6;break}s("setIsAuthor",!0),t.next=12;break;case 6:if("2"!==e.type||!e.blogid){t.next=12;break}return r={params:{where:{blogid:e.blogid},include:"user"}},t.next=10,ft.get(at.blogsAPI,r);case 10:(i=t.sent)&&i.results&&i.results[0]&&(c=i.results[0],s("setBlog",c),s("setIsAuthor",o.userInfo&&c.user.userId===o.userInfo.userId),a("viewLikes",{likeid:c.likeid}),a("viewCommons",{commentid:c.commentid}),a("viewCollects",{collectid:c.collectid}));case 12:return t.abrupt("return",!0);case 15:return t.prev=15,t.t0=t.catch(0),t.abrupt("return",!1);case 18:case"end":return t.stop()}},t,n,[[0,15]])}))()},createBlog:function(t,e){var n=this,a=t.rootState;return p()(l.a.mark(function t(){var s,o,r;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,s=a.userInfo&&a.userInfo.infoId||"",o={__type:"Pointer",className:"userInfo",objectId:s},t.next=5,ft.post(at.blogListAPI,et()({},e.params1,{type:"1",user:o}),{headers:{"X-LC-Session":a.userInfo.sessionToken}});case 5:return r=t.sent,t.next=8,ft.post(at.blogsAPI,et()({},e.params2,{type:"1",user:o,blogid:r.objectId}),{headers:{"X-LC-Session":a.userInfo.sessionToken}});case 8:return t.abrupt("return",!0);case 11:return t.prev=11,t.t0=t.catch(0),t.abrupt("return",!1);case 14:case"end":return t.stop()}},t,n,[[0,11]])}))()},updateBlog:function(t,e){var n=this,a=t.state,s=t.rootState;return p()(l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ft.put(at.blogListAPI+"/"+a.blogData.blogid,et()({},e.params1,{type:"2"}),{headers:{"X-LC-Session":s.userInfo.sessionToken}});case 3:return t.next=5,ft.put(at.blogsAPI+"/"+a.blogData.objectId,et()({},e.params2,{type:"2"}),{headers:{"X-LC-Session":s.userInfo.sessionToken}});case 5:return t.abrupt("return",!0);case 8:return t.prev=8,t.t0=t.catch(0),t.abrupt("return",!1);case 11:case"end":return t.stop()}},t,n,[[0,8]])}))()},deleteBlog:function(t){var e=this,n=t.state,a=t.rootState;return p()(l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ft.delete(at.blogListAPI+"/"+n.blogData.blogid,{headers:{"X-LC-Session":a.userInfo.sessionToken}});case 3:return t.next=5,ft.delete(at.blogsAPI+"/"+n.blogData.objectId,{headers:{"X-LC-Session":a.userInfo.sessionToken}});case 5:return t.abrupt("return",!0);case 8:return t.prev=8,t.t0=t.catch(0),t.abrupt("return",!1);case 11:case"end":return t.stop()}},t,e,[[0,8]])}))()},viewCollects:function(t){var e=this,n=t.commit,a=t.state,s=t.rootState;return p()(l.a.mark(function t(){var o,r,i,c,u,p;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,o={params:{where:{blog:{__type:"Pointer",className:"blogList",objectId:a.blogData.blogid}},include:"user",order:"-createdAt"}},t.next=4,ft.get(at.collectsAPI,o);case 4:for(r=t.sent,i=r&&r.results||[],c=!1,u=0;u<i.length;u++)p=i[u],s.userInfo&&p.user.userId===s.userInfo.userId&&(c=!0);return n("setCollectList",i),n("setIsCollected",c),t.abrupt("return",!0);case 13:return t.prev=13,t.t0=t.catch(0),t.abrupt("return",!1);case 16:case"end":return t.stop()}},t,e,[[0,13]])}))()},collectBlog:function(t){var e=this,n=t.dispatch,a=t.state,s=t.rootState;return p()(l.a.mark(function t(){var o,r;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=s.userInfo&&s.userInfo.infoId||"",r={blog:{__type:"Pointer",className:"blogList",objectId:a.blogData.blogid},user:{__type:"Pointer",className:"userInfo",objectId:o}},t.prev=2,t.next=5,ft.put(at.blogListAPI+"/"+a.blogData.blogid,{collect:{__op:"Increment",amount:1}},{headers:{"X-LC-Session":s.userInfo.sessionToken}});case 5:return t.next=7,ft.post(at.collectsAPI,r,{headers:{"X-LC-Session":s.userInfo.sessionToken}});case 7:return n("viewCollects"),t.abrupt("return",!0);case 11:return t.prev=11,t.t0=t.catch(2),t.abrupt("return",!1);case 14:case"end":return t.stop()}},t,e,[[2,11]])}))()},uncollectBlog:function(t){var e=this,n=t.dispatch,a=t.state,s=t.rootState;return p()(l.a.mark(function t(){var o,r,i,c;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,o=s.userInfo&&s.userInfo.infoId||"",r={params:{where:{blog:{__type:"Pointer",className:"blogList",objectId:a.blogData.blogid},user:{__type:"Pointer",className:"userInfo",objectId:o}}}},t.next=5,ft.put(at.blogListAPI+"/"+a.blogData.blogid,{collect:{__op:"Increment",amount:-1}},{headers:{"X-LC-Session":s.userInfo.sessionToken}});case 5:return t.next=7,ft.get(at.collectsAPI,r);case 7:return i=t.sent,c=i&&i.results&&i.results[0]||"",t.next=11,ft.delete(at.collectsAPI+"/"+c.objectId,{headers:{"X-LC-Session":s.userInfo.sessionToken}});case 11:return n("viewCollects"),t.abrupt("return",!0);case 15:return t.prev=15,t.t0=t.catch(0),t.abrupt("return",!1);case 18:case"end":return t.stop()}},t,e,[[0,15]])}))()},viewLikes:function(t){var e=this,n=t.commit,a=t.state,s=t.rootState;return p()(l.a.mark(function t(){var o,r,i,c,u,p;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,o={params:{where:{blog:{__type:"Pointer",className:"blogList",objectId:a.blogData.blogid}},include:"user",order:"-createdAt"}},t.next=4,ft.get(at.likesAPI,o);case 4:for(r=t.sent,i=r&&r.results||[],c=!1,u=0;u<i.length;u++)p=i[u],s.userInfo&&p.user.userId===s.userInfo.userId&&(c=!0);return n("setLikeList",i),n("setIsLiked",c),t.abrupt("return",!0);case 13:return t.prev=13,t.t0=t.catch(0),t.abrupt("return",!1);case 16:case"end":return t.stop()}},t,e,[[0,13]])}))()},likeBlog:function(t){var e=this,n=t.dispatch,a=t.state,s=t.rootState;return p()(l.a.mark(function t(){var o,r;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,o=s.userInfo&&s.userInfo.infoId||"",r={blog:{__type:"Pointer",className:"blogList",objectId:a.blogData.blogid},user:{__type:"Pointer",className:"userInfo",objectId:o}},t.next=5,ft.put(at.blogListAPI+"/"+a.blogData.blogid,{like:{__op:"Increment",amount:1}},{headers:{"X-LC-Session":s.userInfo.sessionToken}});case 5:return t.next=7,ft.post(at.likesAPI,r,{headers:{"X-LC-Session":s.userInfo.sessionToken}});case 7:return n("viewLikes"),t.abrupt("return",!0);case 11:return t.prev=11,t.t0=t.catch(0),t.abrupt("return",!1);case 14:case"end":return t.stop()}},t,e,[[0,11]])}))()},unlikeBlog:function(t){var e=this,n=t.dispatch,a=t.state,s=t.rootState;return p()(l.a.mark(function t(){var o,r,i,c;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,o=s.userInfo&&s.userInfo.infoId||"",r={params:{where:{blog:{__type:"Pointer",className:"blogList",objectId:a.blogData.blogid},user:{__type:"Pointer",className:"userInfo",objectId:o}}}},t.next=5,ft.put(at.blogListAPI+"/"+a.blogData.blogid,{like:{__op:"Increment",amount:-1}},{headers:{"X-LC-Session":s.userInfo.sessionToken}});case 5:return t.next=7,ft.get(at.likesAPI,r);case 7:return i=t.sent,c=i&&i.results&&i.results[0]||"",t.next=11,ft.delete(at.likesAPI+"/"+c.objectId,{headers:{"X-LC-Session":s.userInfo.sessionToken}});case 11:return n("viewLikes"),t.abrupt("return",!0);case 15:return t.prev=15,t.t0=t.catch(0),t.abrupt("return",!1);case 18:case"end":return t.stop()}},t,e,[[0,15]])}))()},viewCommons:function(t,e){var n=this,a=t.commit,s=t.state;return p()(l.a.mark(function t(){var o,r,i;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,o={params:{where:{blog:{__type:"Pointer",className:"blogList",objectId:s.blogData.blogid}},include:"user",order:"-createdAt",limit:s.commentData.per,skip:0,count:1}},!e||!e.pageDown){t.next=11;break}if(o.params.limit=(s.commentData.page+1)*s.commentData.per,o.params.skip=s.commentData.page*s.commentData.per,!(s.commentData.total<=o.params.skip)){t.next=8;break}return a("setCommentEnding",!0),t.abrupt("return",!0);case 8:a("setCommentPage",s.commentData.page+1),t.next=13;break;case 11:a("setCommentEnding",!1),a("setCommentPage",1);case 13:return t.next=15,ft.get(at.commentsAPI,o);case 15:return r=t.sent,a("setCommentTotal",r.count||0),i=r&&r.results||[],e&&e.pageDown?a("setCommentList",s.commentData.list.concat(i)):a("setCommentList",i),t.abrupt("return",!0);case 22:return t.prev=22,t.t0=t.catch(0),t.abrupt("return",!1);case 25:case"end":return t.stop()}},t,n,[[0,22]])}))()},commentBlog:function(t,e){var n=this,a=t.dispatch,s=t.state,o=t.rootState;return p()(l.a.mark(function t(){var r,i;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=o.userInfo&&o.userInfo.infoId||"",i={blog:{__type:"Pointer",className:"blogList",objectId:s.blogData.blogid},user:{__type:"Pointer",className:"userInfo",objectId:r},comment:e.comment},t.next=5,ft.put(at.blogListAPI+"/"+s.blogData.blogid,{comment:{__op:"Increment",amount:1}},{headers:{"X-LC-Session":o.userInfo.sessionToken}});case 5:return t.next=7,ft.post(at.commentsAPI,i,{headers:{"X-LC-Session":o.userInfo.sessionToken}});case 7:return a("viewCommons"),t.abrupt("return",!0);case 11:return t.prev=11,t.t0=t.catch(0),t.abrupt("return",!1);case 14:case"end":return t.stop()}},t,n,[[0,11]])}))()}},mutations:{initData:function(t){t.blogData={},t.isAuthor=!1,t.likeData={list:[],isLiked:!1},t.collectData={list:[],isCollected:!1},t.comments=[]},setBlog:function(t,e){t.blogData=e},setIsAuthor:function(t,e){t.isAuthor=e},setCollectList:function(t,e){t.collectData.list=e},setIsCollected:function(t,e){t.collectData.isCollected=e},setLikeList:function(t,e){t.likeData.list=e},setIsLiked:function(t,e){t.likeData.isLiked=e},setCommentList:function(t,e){t.commentData.list=e},setCommentPage:function(t,e){t.commentData.page=e},setCommentTotal:function(t,e){t.commentData.total=e},setCommentEnding:function(t,e){t.commentData.isEnding=e}}},It={namespaced:!0,state:{isAuthor:!1,userData:{},blogList:[],pageData:{page:1,per:10,total:1,isEnding:!1}},getters:{userInfo:function(t,e,n){return n.userInfo},userData:function(t){return t.userData},blogList:function(t){return t.blogList},isEnding:function(t){return t.pageData.isEnding},isAuthor:function(t){return t.isAuthor}},actions:{getUser:function(t,e){var n=this,a=t.commit,s=t.rootState;return p()(l.a.mark(function t(){var o,r,i;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a("initData"),o=!1,r={params:{keys:"-email,-username"}},s.userInfo&&e.userId===s.userInfo.userId&&(o=!0,r={}),a("setIsAuthor",o),t.next=8,ft.get(at.userAPI+"/"+e.userId,r);case 8:return(i=t.sent)&&a("setUserData",i),t.abrupt("return",!0);case 13:return t.prev=13,t.t0=t.catch(0),t.abrupt("return",!1);case 16:case"end":return t.stop()}},t,n,[[0,13]])}))()},viewBlog:function(t,e){var n=this,a=t.commit,s=t.state;return p()(l.a.mark(function t(){var o,r,i;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,o={params:{where:{user:{__type:"Pointer",className:"userInfo",objectId:e.infoId}},include:"user",order:"-createdAt",limit:s.pageData.per,skip:0,count:1}},!e.pageDown){t.next=11;break}if(o.params.limit=(s.pageData.page+1)*s.pageData.per,o.params.skip=s.pageData.page*s.pageData.per,!(s.pageData.total<=o.params.skip)){t.next=8;break}return a("setIsEnding",!0),t.abrupt("return",!0);case 8:a("setPage",s.pageData.page+1),t.next=13;break;case 11:a("setIsEnding",!1),a("setPage",1);case 13:if(r=null,i=[],"1"!==e.blogType){t.next=22;break}return t.next=18,ft.get(at.blogListAPI,o);case 18:r=t.sent,i=r&&r.results||[],t.next=38;break;case 22:if("2"!==e.blogType){t.next=31;break}return o.params.include="blog.user",t.next=26,ft.get(at.collectsAPI,o);case 26:r=t.sent,(r&&r.results||[]).forEach(function(t){t.paragraph&&i.push(t.blog)}),t.next=38;break;case 31:if("3"!==e.blogType){t.next=38;break}return o.params.include="blog.user",t.next=35,ft.get(at.likesAPI,o);case 35:r=t.sent,(r&&r.results||[]).forEach(function(t){t.paragraph&&i.push(t.blog)});case 38:return a("setTotal",r.count||1),e.pageDown?a("setBlogList",s.blogList.concat(i)):a("setBlogList",i),t.abrupt("return",!0);case 43:return t.prev=43,t.t0=t.catch(0),t.abrupt("return",!1);case 46:case"end":return t.stop()}},t,n,[[0,43]])}))()},updateUser:function(t,e){var n=this,a=t.dispatch,s=t.rootState;return p()(l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ft.put(at.userAPI+"/"+s.userInfo.userId,e,{headers:{"X-LC-Session":s.userInfo.sessionToken}});case 3:return t.next=5,ft.put(at.userInfoAPI+"/"+s.userInfo.infoId,{nickname:e.nickname,avatar:e.avatar,sign:e.sign});case 5:return t.next=7,a("getUser",{userId:s.userInfo.userId});case 7:return t.abrupt("return",!0);case 10:return t.prev=10,t.t0=t.catch(0),t.abrupt("return",!1);case 13:case"end":return t.stop()}},t,n,[[0,10]])}))()}},mutations:{initData:function(t){t.userData={},t.blogList=[],t.isAuthor=!1},setUserData:function(t,e){t.userData=e},setIsAuthor:function(t,e){t.isAuthor=e},setPage:function(t,e){t.pageData.page=e},setTotal:function(t,e){t.pageData.total=e},setIsEnding:function(t,e){t.pageData.isEnding=e},setBlogList:function(t,e){t.blogList=e}}};s.a.use(C.b);var xt=new C.b.Store({state:{userInfo:b("Blog_userInfo")&&JSON.parse(b("Blog_userInfo"))||null},getters:a,actions:vt,mutations:kt,modules:{home:Ct,blog:_t,user:It}});n("4wdT"),n("d8+G");s.a.config.productionTip=!1,s.a.prototype.$toast=v,new s.a({el:"#app",router:K,store:xt,components:{App:r},template:"<App/>"})},OeVF:function(t,e){},Wej4:function(t,e){},"d8+G":function(t,e){},"gOi+":function(t,e){},"gnv+":function(t,e){},m4Sm:function(t,e){},mz16:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.058c20402ae99f922719.js.map