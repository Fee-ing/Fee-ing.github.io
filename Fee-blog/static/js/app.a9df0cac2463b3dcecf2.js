webpackJsonp([1],{"4wdT":function(t,e){},HUY3:function(t,e){},LlRp:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={};a.d(n,"userInfo",function(){return Z});var s=a("7+uW"),o={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("div",{attrs:{id:"toast"}}),this._v(" "),e("router-view")],1)},staticRenderFns:[]},r=a("VU/8")({name:"App"},o,!1,null,null,null).exports,i=a("/ocq"),c=a("Xxa5"),l=a.n(c),u=a("exGp"),p=a.n(u),d=a("Dd8w"),g=a.n(d),m=a("L6bb"),f=a.n(m);function v(t){var e=document.getElementById("toast")||null;if(e&&""===e.className){var a={duration:t.duration||2e3,title:t.title||""};e.innerHTML=a.title,e.className="show",setTimeout(function(){e.className="",e.innerHTML=""},a.duration)}}function b(t){var e=new RegExp("(^| )"+t+"=([^;]*)(;|$)");return document.cookie.match(e)?unescape(document.cookie.match(e)[2]):null}function h(t,e){localStorage.setItem(t,e)}function k(t,e){var a,n,s,o,r,i,c,l,u,p,d,g,m=e||"1",f=new Date(t),v=new Date;return a=parseInt(f.getFullYear()),n=parseInt(f.getMonth())+1,s=parseInt(f.getDate()),o=parseInt(f.getHours()),r=parseInt(f.getMinutes()),i=parseInt(f.getSeconds()),c=parseInt(v.getFullYear()),l=parseInt(v.getMonth())+1,u=parseInt(v.getDate()),p=parseInt(v.getHours()),d=parseInt(v.getMinutes()),g=parseInt(v.getSeconds()),"2"===m?a+"年"+n+"月"+s+"号 "+o+"点"+r+"分":c-a>1?c-a+"年前"+n+"月"+s+"号"+o+"点":c-a>0?"去年"+n+"月"+s+"号"+o+"点":l-n>0?"今年"+n+"月"+s+"号"+o+"点":u-s>1?u-s+"天前"+o+"点":u-s>0?"昨天"+o+"点":p-o>0?p-o+"小时前":d-r>0?d-r+"分钟前":g-i>0?g-i+"秒前":"刚刚"}var _=a("NYxO"),C=/^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/,x=/^[a-z0-9]{6,11}$/,w={name:"Login",data:function(){return{type:"1",loginForm:{phone:(t="Blog_phone",localStorage.getItem(t)||""),password:""},registForm:{phone:"",password:"",confirmPass:""}};var t},methods:g()({},Object(_.c)(["login","regist"]),{loginOpt:function(){var t=this;return p()(l.a.mark(function e(){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("2"!==t.type){e.next=3;break}return t.type="1",e.abrupt("return");case 3:if(C.test(t.loginForm.phone)){e.next=6;break}return t.$toast({title:"请填写正确的手机号"}),e.abrupt("return");case 6:if(x.test(t.loginForm.password)){e.next=9;break}return t.$toast({title:"请填写正确的密码"}),e.abrupt("return");case 9:return a={username:t.loginForm.phone,password:f()(t.loginForm.password)},e.next=12,t.login(a);case 12:e.sent&&(t.$toast({title:"登录成功"}),h("Blog_phone",t.loginForm.phone),t.$router.replace({path:"/"}));case 14:case"end":return e.stop()}},e,t)}))()},registOpt:function(){var t=this;return p()(l.a.mark(function e(){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("1"!==t.type){e.next=3;break}return t.type="2",e.abrupt("return");case 3:if(C.test(t.registForm.phone)){e.next=6;break}return t.$toast({title:"请填写正确的手机号"}),e.abrupt("return");case 6:if(x.test(t.registForm.password)){e.next=9;break}return t.$toast({title:"请填写正确的密码"}),e.abrupt("return");case 9:if(t.registForm.confirmPass===t.registForm.password){e.next=12;break}return t.$toast({title:"请填写正确的确认密码"}),e.abrupt("return");case 12:return a={username:t.registForm.phone,password:f()(t.registForm.password),nickname:"游客"+f()(t.registForm.phone).substr(0,6),avatar:"",location:"",qq:"",wechat:"",sign:""},e.next=15,t.regist(a);case 15:e.sent&&(t.$toast({title:"注册成功"}),h("Blog_phone",t.registForm.phone),t.$router.replace({path:"/"}));case 17:case"end":return e.stop()}},e,t)}))()}})},I={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page-wrapper"},[a("div",{staticClass:"page-header"},[a("div",{staticClass:"page-header-content login-header"},[a("div",{staticClass:"common-btn back-btn",on:{click:function(e){t.$router.go(-1)}}},[t._v("返回")])])]),t._v(" "),a("div",{staticClass:"login-wrapper"},[a("div",{staticClass:"login-form"},[a("div",{staticClass:"input-wrapper"},["1"===t.type?[a("input",{directives:[{name:"model",rawName:"v-model",value:t.loginForm.phone,expression:"loginForm.phone"}],staticClass:"common-input",attrs:{type:"text",placeholder:"手机号"},domProps:{value:t.loginForm.phone},on:{input:function(e){e.target.composing||t.$set(t.loginForm,"phone",e.target.value)}}}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.loginForm.password,expression:"loginForm.password"}],staticClass:"common-input",attrs:{type:"password",placeholder:"密码（6-10位、由字母或数字组成）"},domProps:{value:t.loginForm.password},on:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.loginOpt(e):null},input:function(e){e.target.composing||t.$set(t.loginForm,"password",e.target.value)}}})]:t._e(),t._v(" "),"2"===t.type?[a("input",{directives:[{name:"model",rawName:"v-model",value:t.registForm.phone,expression:"registForm.phone"}],staticClass:"common-input",attrs:{type:"text",placeholder:"手机号"},domProps:{value:t.registForm.phone},on:{input:function(e){e.target.composing||t.$set(t.registForm,"phone",e.target.value)}}}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.registForm.password,expression:"registForm.password"}],staticClass:"common-input",attrs:{type:"password",placeholder:"密码（6-10位、由字母或数字组成）"},domProps:{value:t.registForm.password},on:{input:function(e){e.target.composing||t.$set(t.registForm,"password",e.target.value)}}}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.registForm.confirmPass,expression:"registForm.confirmPass"}],staticClass:"common-input",attrs:{type:"password",placeholder:"确认密码"},domProps:{value:t.registForm.confirmPass},on:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.registOpt(e):null},input:function(e){e.target.composing||t.$set(t.registForm,"confirmPass",e.target.value)}}})]:t._e()],2),t._v(" "),a("div",{staticClass:"btn-wrapper"},[a("div",{staticClass:"btn",class:["1"===t.type?"common-btn":""],on:{click:t.loginOpt}},[t._v("登录")]),t._v(" "),a("div",{staticClass:"btn",class:["2"===t.type?"common-btn":""],on:{click:t.registOpt}},[t._v("注册")]),t._v(" "),a("a",{staticClass:"btn",attrs:{target:"_blank",href:"https://github.com/Fee-ing"}},[t._v("GitHub")])])])])])},staticRenderFns:[]};var y=a("VU/8")(w,I,!1,function(t){a("mz16")},"data-v-d6a4599c",null).exports,D={props:{userInfo:{type:Object,default:function(){return{}}},showSign:{type:Boolean,default:!1}},data:function(){return{}},methods:{viewUserOpt:function(){var t=this.userInfo.objectId||"";t&&this.$router.push({path:"/user",query:{userid:t}})}}},B={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"user-wrapper",on:{click:function(e){return e.stopPropagation(),t.viewUserOpt(e)}}},[t.userInfo.avatar?a("div",{staticClass:"user-avatar background-image",style:{backgroundImage:"url("+t.userInfo.avatar+")"}}):a("div",{staticClass:"user-avatar background-image user-avatar-default"}),t._v(" "),a("div",{staticClass:"user-info"},[a("div",{staticClass:"user-name"},[t._v(t._s(t.userInfo.nickname))]),t._v(" "),t.showSign&&t.userInfo.sign?a("div",{staticClass:"info-item"},[t._v(t._s(t.userInfo.sign))]):t._e(),t._v(" "),t._t("user-others")],2)])},staticRenderFns:[]};var P=a("VU/8")(D,B,!1,function(t){a("LlRp")},"data-v-74681b14",null).exports,L={props:{blogData:{type:Object,default:function(){return{}}},showSign:{type:Boolean,default:!1}},data:function(){return{}},components:{userCommon:P},methods:{formatTime:k,viewOpt:function(){var t=this.blogData.objectId||"";t&&this.$router.push({path:"/blog",query:{blogid:t}})}}},T={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"blog-wrapper",on:{click:function(e){return e.stopPropagation(),t.viewOpt(e)}}},[a("div",{staticClass:"blog-header"},[a("userCommon",{staticClass:"blog-user",attrs:{userInfo:t.blogData.user,showSign:t.showSign}})],1),t._v(" "),a("div",{staticClass:"blog-body"},[t.blogData.cover?a("div",{staticClass:"blog-cover background-image",style:{backgroundImage:"url("+t.blogData.cover+")"}}):t._e(),t._v(" "),a("div",{staticClass:"blog-paragraph",domProps:{innerHTML:t._s(t.blogData.paragraph)}})]),t._v(" "),a("div",{staticClass:"blog-footer"},[a("div",{staticClass:"blog-time"},[t._v(t._s("1"===t.blogData.type?t.formatTime(t.blogData.createdAt)+"发布":t.formatTime(t.blogData.updatedAt)+"更新"))]),t._v(" "),a("div",{staticClass:"blog-info"},[a("div",{staticClass:"info-item"},[a("span",[t._v("喜欢")]),t._v(t._s(t.blogData.like||0))]),t._v(" "),a("div",{staticClass:"info-item"},[a("span",[t._v("评论")]),t._v(t._s(t.blogData.comment||0))]),t._v(" "),a("div",{staticClass:"info-item"},[a("span",[t._v("浏览")]),t._v(t._s(t.blogData.view||0))])])])])},staticRenderFns:[]};var A=a("VU/8")(L,T,!1,function(t){a("kiI7")},"data-v-2b0078d0",null).exports,$={name:"Home",data:function(){return{isLoading:!1}},components:{userCommon:P,blogCommon:A},computed:g()({},Object(_.d)({blogList:"home/blogList",isEnding:"home/isEnding",userInfo:"userInfo"})),created:function(){var t=this;return p()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.next=3,t.getBlogList();case 3:t.isLoading=!1;case 4:case"end":return e.stop()}},e,t)}))()},mounted:function(){var t,e=this,a=this;document.querySelector(".page-wrapper").addEventListener("scroll",(t=p()(l.a.mark(function t(n){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n.target.offsetHeight+n.target.scrollTop+100>=n.target.scrollHeight)||a.isLoading||a.isEnding){t.next=5;break}return a.isLoading=!0,t.next=4,a.getBlogList({pageDown:!0});case 4:a.isLoading=!1;case 5:case"end":return t.stop()}},t,e)})),function(e){return t.apply(this,arguments)}))},methods:g()({},Object(_.c)({logout:"logout",getBlogList:"home/getBlogList"}),{loginOpt:function(){this.$router.push("login")},logoutOpt:function(){this.logout(),this.$toast({title:"退出成功"})}})},O={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page-wrapper"},[a("div",{staticClass:"page-header"},[a("div",{staticClass:"page-header-content home-header"},[a("div",{staticClass:"home-header-title"},[a("span",{on:{click:t.getBlogList}},[t._v("搭建免费博客")])]),t._v(" "),t.userInfo?[a("userCommon",{staticClass:"home-header-user",attrs:{userInfo:t.userInfo,title:"个人信息"}},[a("template",{slot:"user-others"},[a("div",{staticClass:"user-logout",attrs:{title:"退出登录"},on:{click:function(e){return e.stopPropagation(),t.logoutOpt(e)}}},[t._v("退出登录")])])],2),t._v(" "),a("div",{staticClass:"common-btn",on:{click:function(e){t.$router.push("blog")}}},[t._v("写博客")])]:a("div",{staticClass:"common-btn",on:{click:t.loginOpt}},[t._v("登录 / 注册")])],2)]),t._v(" "),a("div",{staticClass:"page-body"},[a("div",{staticClass:"page-body-content"},[t._l(t.blogList,function(t,e){return a("blogCommon",{key:e,attrs:{blogData:t,showSign:!0}})}),t._v(" "),a("div",{staticClass:"page-tip"},[t.isEnding?a("span",[t._v("没有更多啦~")]):!t.isEnding&&t.isLoading?a("span",[t._v("加载中~")]):!t.isEnding&&!t.isLoading&&t.blogList.length<=0?a("span",[t._v("这里什么也没有~")]):t._e()])],2)])])},staticRenderFns:[]};var j=a("VU/8")($,O,!1,function(t){a("pgqj")},"data-v-0b60a680",null).exports,F=a("U7mS"),S=a.n(F),E={props:{showDelete:{type:Boolean,default:!1}},data:function(){return{colorList:[{color:"ffffff",title:"白"},{color:"0d0015",title:"漆黑"},{color:"fe2c23",title:"红"},{color:"ff9900",title:"橙"},{color:"ffd900",title:"黄"},{color:"a3e043",title:"葱绿"},{color:"37d9f0",title:"湖蓝"},{color:"4da8ee",title:"天蓝"},{color:"aa17d0",title:"紫"},{color:"f3f3f1",title:"白练"},{color:"949494",title:"鼠灰"},{color:"fcdbd6",title:"虹"},{color:"fde9d0",title:"薄卵"},{color:"fff0cf",title:"蒸栗"},{color:"d4e9d6",title:"白绿"},{color:"def3f3",title:"蓝白"},{color:"cee0ef",title:"天空"},{color:"dfdbec",title:"紫水晶"},{color:"dcdedd",title:"白鼠"},{color:"595856",title:"墨"},{color:"ee837d",title:"甚三红"},{color:"f8c387",title:"雄黄"},{color:"e6b322",title:"金色"},{color:"9abd9d",title:"薄青"},{color:"83ccd2",title:"白群"},{color:"89b0ce",title:"薄花"},{color:"9389b1",title:"紫苑"},{color:"c1c6ca",title:"灰青"},{color:"41464b",title:"石墨"},{color:"d51228",title:"绯红"},{color:"cf770b",title:"红金"},{color:"8d634a",title:"枯茶"},{color:"557b5c",title:"绿青"},{color:"01a3b0",title:"浅葱"},{color:"3776a6",title:"薄缥"},{color:"765c83",title:"紫霞"},{color:"adadad",title:"薄钝"},{color:"2b2b2b",title:"黑"},{color:"a91913",title:"朱绯"},{color:"884702",title:"褐"},{color:"563725",title:"黑茶"},{color:"00552e",title:"深绿"},{color:"00767a",title:"苍蓝"},{color:"194e77",title:"琉璃"},{color:"530e6f",title:"葡萄"}],fontsizeBol:!1,fontcolorBol:!1,backcolorBol:!1,alignBol:!1,textBol:!1,fontsizeText:"字号",fontColorText:"transparent",backColorText:"transparent",alignText:"",pic:""}},mounted:function(){var t=this;document.onclick=function(e){"link-blank"===e.target.className&&e.target.getAttribute("href")&&window.open(e.target.getAttribute("href")),t.init()}},methods:{removeClass:function(t,e){var a=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(a,"")},init:function(){this.clearStyle(),this.initStyle()},initMenuBol:function(){this.fontsizeBol=!1,this.alignBol=!1,this.backcolorBol=!1,this.fontcolorBol=!1,this.textBol=!1},initStyle:function(){this.fontsizeText="字号",this.fontColorText="transparent",this.backColorText="transparent",this.alignText="",this.initMenuBol()},clearStyle:function(){var t=this;(document.querySelectorAll(".toolbar-item")||[]).forEach(function(e){t.removeClass(e,"active")})},initBol:function(t,e){var a=this;this.clearStyle(),t.className+=" active";["fontsizeBol","alignBol","backcolorBol","fontcolorBol","textBol"].forEach(function(t){if(t===e){var n=a[e];a[e]=!n}else a[t]=!1})},getFontsize:function(t){this.initBol(t.currentTarget,"fontsizeBol")},getFontcolor:function(t){this.initBol(t.currentTarget,"fontcolorBol")},getBackcolor:function(t){this.initBol(t.currentTarget,"backcolorBol")},getAlign:function(t){this.initBol(t.currentTarget,"alignBol")},getText:function(t){this.initBol(t.currentTarget,"textBol")},execCommandOpt:function(t){this.initBol(t.currentTarget,null);var e=t.currentTarget.getAttribute("data-key");document.execCommand(e,!1,null)},createLinkOpt:function(t){this.initBol(t.currentTarget,null);var e=document.getSelection();if(""!==e.toString().replace(/(^\s*)|(\s*$)/g,"")){var a=window.prompt("请输入链接","http://");document.execCommand("insertHTML",!1,'<a class="link-blank" href="'+a+'" target="_blank">'+e+"</a>")}},fontSize:function(t,e){document.execCommand("fontSize",!1,t),this.fontsizeText=e,this.fontcolorBol=!1},fontColor:function(t){document.execCommand("ForeColor",!1,t),this.fontColorText=t,this.fontcolorBol=!1},backColor:function(t){document.execCommand("BackColor",!1,t),this.backColorText=t,this.backcolorBol=!1},alignOpt:function(t){document.execCommand(t,!1,null),this.alignText=t,this.alignBol=!1},addText:function(t){document.execCommand("formatBlock",!1,"<"+t+">"),this.textBol=!1},addImg:function(){var t=this,e=this;S()(event.currentTarget.files[0]).then(function(t){e.pic=t.base64,e.$emit("add-img",t.base64)}).catch(function(){t.$toast({title:"图片上传失败"})})},clearOpt:function(){this.$emit("clear-html")},deleteOpt:function(){window.confirm("确认删除文章？")&&this.$emit("deltet-blog")},saveOpt:function(){this.$emit("add-blog")}}},q={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"edit-header"},[a("ul",{staticClass:"editbar-list"},[a("li",{staticClass:"editbar-list-item"},[a("button",{staticClass:"toolbar-item undo",attrs:{type:"button",unselectable:"on",title:"撤销","data-key":"undo"},on:{click:function(e){return e.stopPropagation(),t.execCommandOpt(e)}}}),t._v(" "),a("button",{staticClass:"toolbar-item redo",attrs:{type:"button",unselectable:"on",title:"重做","data-key":"redo"},on:{click:function(e){return e.stopPropagation(),t.execCommandOpt(e)}}}),t._v(" "),a("button",{staticClass:"toolbar-item clear-format",attrs:{type:"button",unselectable:"on",title:"清除格式","data-key":"removeFormat"},on:{click:function(e){return e.stopPropagation(),t.execCommandOpt(e)}}})]),t._v(" "),a("li",{staticClass:"separator editbar-list-item"}),t._v(" "),a("li",{staticClass:"editbar-list-item"},[a("ul",{directives:[{name:"show",rawName:"v-show",value:t.fontsizeBol,expression:"fontsizeBol"}],staticClass:"toolbar-menu toolbar-menu-list toolbar-text-list"},[a("li",{staticClass:"menu-list-item"},[a("button",{attrs:{type:"button",unselectable:"on",title:"10px"},on:{click:function(e){e.stopPropagation(),t.fontSize("1","10px")}}},[t._v("10px")])]),t._v(" "),a("li",{staticClass:"menu-list-item"},[a("button",{attrs:{type:"button",unselectable:"on",title:"13px"},on:{click:function(e){e.stopPropagation(),t.fontSize("2","13px")}}},[t._v("13px")])]),t._v(" "),a("li",{staticClass:"menu-list-item"},[a("button",{attrs:{type:"button",unselectable:"on",title:"16px"},on:{click:function(e){e.stopPropagation(),t.fontSize("3","16px")}}},[t._v("16px")])]),t._v(" "),a("li",{staticClass:"menu-list-item"},[a("button",{attrs:{type:"button",unselectable:"on",title:"18px"},on:{click:function(e){e.stopPropagation(),t.fontSize("4","18px")}}},[t._v("18px")])]),t._v(" "),a("li",{staticClass:"menu-list-item"},[a("button",{attrs:{type:"button",unselectable:"on",title:"24px"},on:{click:function(e){e.stopPropagation(),t.fontSize("5","24px")}}},[t._v("24px")])]),t._v(" "),a("li",{staticClass:"menu-list-item"},[a("button",{attrs:{type:"button",unselectable:"on",title:"32px"},on:{click:function(e){e.stopPropagation(),t.fontSize("6","32px")}}},[t._v("32px")])]),t._v(" "),a("li",{staticClass:"menu-list-item"},[a("button",{attrs:{type:"button",unselectable:"on",title:"48px"},on:{click:function(e){e.stopPropagation(),t.fontSize("7","48px")}}},[t._v("48px")])])]),t._v(" "),t.fontcolorBol?a("ul",{staticClass:"toolbar-menu toolbar-color-list"},t._l(t.colorList,function(e,n){return a("li",{key:n,staticClass:"color-list-item"},[a("button",{style:{backgroundColor:"#"+e.color},attrs:{type:"button",unselectable:"on",title:e.title},on:{click:function(a){a.stopPropagation(),t.fontColor("#"+e.color)}}})])})):t._e(),t._v(" "),t.backcolorBol?a("ul",{staticClass:"toolbar-menu toolbar-color-list toolbar-color-list1"},t._l(t.colorList,function(e,n){return a("li",{key:n,staticClass:"color-list-item"},[a("button",{style:{backgroundColor:"#"+e.color},attrs:{type:"button",unselectable:"on",title:e.title},on:{click:function(a){a.stopPropagation(),t.backColor("#"+e.color)}}})])})):t._e(),t._v(" "),t.alignBol?a("ul",{staticClass:"toolbar-menu toolbar-menu-list toolbar-align-list"},[a("li",{staticClass:"menu-list-item"},[a("button",{attrs:{type:"button",unselectable:"on",title:"左对齐"},on:{click:function(e){e.stopPropagation(),t.alignOpt("justifyLeft")}}},[a("span",{staticClass:"menu-list-left"})])]),t._v(" "),a("li",{staticClass:"menu-list-item"},[a("button",{attrs:{type:"button",unselectable:"on",title:"居中"},on:{click:function(e){e.stopPropagation(),t.alignOpt("justifyCenter")}}},[a("span",{staticClass:"menu-list-center"})])]),t._v(" "),a("li",{staticClass:"menu-list-item"},[a("button",{attrs:{type:"button",unselectable:"on",title:"右对齐"},on:{click:function(e){e.stopPropagation(),t.alignOpt("justifyRight")}}},[a("span",{staticClass:"menu-list-right"})])]),t._v(" "),a("li",{staticClass:"menu-list-item"},[a("button",{attrs:{type:"button",unselectable:"on",title:"两端对齐"},on:{click:function(e){e.stopPropagation(),t.alignOpt("justifyFull")}}},[a("span",{staticClass:"menu-list-justify"})])])]):t._e(),t._v(" "),a("button",{staticClass:"toolbar-item toolbar-item-select font",attrs:{type:"button",unselectable:"on",title:"文字"},on:{click:function(e){return e.stopPropagation(),t.getFontsize(e)}}},[t._v("\n        "+t._s(t.fontsizeText)+"\n        "),a("span",{staticClass:"new-icon-down"})]),t._v(" "),a("button",{staticClass:"toolbar-item bold",attrs:{type:"button",unselectable:"on",title:"粗体","data-key":"bold"},on:{click:function(e){return e.stopPropagation(),t.execCommandOpt(e)}}}),t._v(" "),a("button",{staticClass:"toolbar-item italic",attrs:{type:"button",unselectable:"on",title:"斜体","data-key":"italic"},on:{click:function(e){return e.stopPropagation(),t.execCommandOpt(e)}}}),t._v(" "),a("button",{staticClass:"toolbar-item underline",attrs:{type:"button",unselectable:"on",title:"下划线","data-key":"underline"},on:{click:function(e){return e.stopPropagation(),t.execCommandOpt(e)}}}),t._v(" "),a("button",{staticClass:"toolbar-item strikethrough",attrs:{type:"button",unselectable:"on",title:"中划线","data-key":"strikethrough"},on:{click:function(e){return e.stopPropagation(),t.execCommandOpt(e)}}}),t._v(" "),a("button",{staticClass:"toolbar-item link",attrs:{type:"button",unselectable:"on",title:"超链接","data-key":"createLink"},on:{click:function(e){return e.stopPropagation(),t.createLinkOpt(e)}}}),t._v(" "),a("button",{staticClass:"toolbar-item toolbar-item-select fontcolor",attrs:{type:"button",unselectable:"on",title:"字体颜色"},on:{click:function(e){return e.stopPropagation(),t.getFontcolor(e)}}},[a("span",{staticClass:"new-icon-down"}),t._v(" "),a("span",{staticClass:"line",style:{backgroundColor:t.fontColorText}})]),t._v(" "),a("button",{staticClass:"toolbar-item toolbar-item-select backcolor",attrs:{type:"button",unselectable:"on",title:"背景颜色"},on:{click:function(e){return e.stopPropagation(),t.getBackcolor(e)}}},[a("span",{staticClass:"new-icon-down"}),t._v(" "),a("span",{staticClass:"line",style:{backgroundColor:t.backColorText}})]),t._v(" "),a("button",{staticClass:"toolbar-item toolbar-item-select align-toolbar",class:t.alignText,attrs:{type:"button",unselectable:"on",title:"对齐"},on:{click:function(e){return e.stopPropagation(),t.getAlign(e)}}},[a("span",{staticClass:"new-icon-down"})])]),t._v(" "),a("li",{staticClass:"separator editbar-list-item"}),t._v(" "),a("li",{staticClass:"editbar-list-item"},[t.textBol?a("ul",{staticClass:"toolbar-menu toolbar-menu-list toolbar-text-list"},[a("li",{staticClass:"menu-list-item"},[a("button",{attrs:{type:"button",unselectable:"on",title:"段落"},on:{click:function(e){e.stopPropagation(),t.addText("p")}}},[t._v("段落")])]),t._v(" "),a("li",{staticClass:"menu-list-item"},[a("button",{attrs:{type:"button",unselectable:"on",title:"大标题"},on:{click:function(e){e.stopPropagation(),t.addText("h1")}}},[t._v("大标题")])]),t._v(" "),a("li",{staticClass:"menu-list-item"},[a("button",{attrs:{type:"button",unselectable:"on",title:"中标题"},on:{click:function(e){e.stopPropagation(),t.addText("h2")}}},[t._v("中标题")])]),t._v(" "),a("li",{staticClass:"menu-list-item"},[a("button",{attrs:{type:"button",unselectable:"on",title:"小标题"},on:{click:function(e){e.stopPropagation(),t.addText("h3")}}},[t._v("小标题")])])]):t._e(),t._v(" "),a("button",{staticClass:"toolbar-item toolbar-item-select font",attrs:{type:"button",unselectable:"on",title:"文字"},on:{click:function(e){return e.stopPropagation(),t.getText(e)}}},[t._v("文字"),a("span",{staticClass:"new-icon-down"})]),t._v(" "),a("button",{staticClass:"toolbar-item image",attrs:{type:"button",unselectable:"on",title:"图片"}},[a("input",{staticClass:"image-input",attrs:{type:"file",accept:"*.png,*.jpg,*.jpeg,*gif",unselectable:"on"},on:{change:function(e){return e.stopPropagation(),t.addImg(e)}}})]),t._v(" "),a("button",{staticClass:"toolbar-item button edit-button",attrs:{type:"button",unselectable:"on",title:"清空内容"},on:{click:function(e){return e.stopPropagation(),t.clearOpt(e)}}},[t._v("清空内容")]),t._v(" "),t.showDelete?a("button",{staticClass:"toolbar-item button edit-button",attrs:{type:"button",unselectable:"on",title:"删除文章"},on:{click:function(e){return e.stopPropagation(),t.deleteOpt(e)}}},[t._v("删除")]):t._e(),t._v(" "),a("button",{staticClass:"toolbar-item button edit-button",attrs:{type:"button",unselectable:"on",title:"保存"},on:{click:function(e){return e.stopPropagation(),t.saveOpt(e)}}},[t._v("保存")])])])])},staticRenderFns:[]};var U=a("VU/8")(E,q,!1,function(t){a("gnv+")},"data-v-01d4a58e",null).exports,z=Object(_.a)("blog"),H=z.mapGetters,R=z.mapActions,N={data:function(){return{contentWrapper:null,type:"1",commentContent:""}},components:{editHeader:U,userCommon:P},created:function(){var t=this;return p()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.$route.query.blogid?t.type="2":t.type="1",e.next=3,t.getBlog({type:t.type,blogid:t.$route.query.blogid||""});case 3:"2"===t.type&&t.blogData.userid!==t.userInfo.objectId&&t.viewBlog();case 4:case"end":return e.stop()}},e,t)}))()},mounted:function(){this.contentWrapper=document.getElementById("content-wrapper"),this.$route.query.blogid||this.contentWrapper.focus()},computed:g()({},H(["userInfo","blogData","author","showDelete","likeData","collectData","comments"])),methods:g()({},R(["getBlog","createBlog","updateBlog","deleteBlog","likeBlog","unlikeBlog","viewBlog","commentBlog","uncollectBlog","collectBlog"]),{formatTime:k,insertHtmlAtCaret:function(t){var e=void 0,a=void 0;if(window.getSelection){if((e=window.getSelection()).getRangeAt&&e.rangeCount){(a=e.getRangeAt(0)).deleteContents();var n=document.createElement("div");n.innerHTML=t;for(var s=document.createDocumentFragment(),o=void 0,r=void 0;o=n.firstChild;)r=s.appendChild(o);a.insertNode(s),r&&((a=a.cloneRange()).setStartAfter(r),a.collapse(!0),e.removeAllRanges(),e.addRange(a))}}else document.selection&&"Control"!==document.selection.type&&document.selection.createRange().pasteHTML(t)},getBlogInfo:function(t){var e=[],a=/<img.*?(?:>|\/>)/gi,n=/src=['"]?([^'"]*)['"]?/i,s=t.replace(a,"");s.length>150&&(s=s.substr(0,150)+'...<span class="blog-more">查看更多</span>');var o=t.match(a);return o?(o.forEach(function(t){var a=t.match(n);a[1]&&e.push(a[1])}),{cover:e[0],paragraph:s}):{cover:"",paragraph:s}},addImg:function(t){this.contentWrapper.focus();var e='<img src="'+t+'">';this.insertHtmlAtCaret(e)},clearOpt:function(){this.contentWrapper.innerHTML=""},deleteOpt:function(){var t=this;return p()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.deleteBlog();case 2:e.sent&&(t.$toast({title:"删除成功"}),t.$router.go(-1));case 4:case"end":return e.stop()}},e,t)}))()},submitOpt:function(){var t=this;return p()(l.a.mark(function e(){var a,n,s;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==t.contentWrapper.innerHTML.replace(/(^\s*)|(\s*$)/,"")){e.next=2;break}return e.abrupt("return");case 2:if(a=t.contentWrapper.innerHTML.replace(/(^\s*)|(\s*$)/,"").replace(/<script[^>]*>[\s\S]*?<\/[^>]*script>/gi,""),n=t.getBlogInfo(a),s={params1:{cover:n.cover,paragraph:n.paragraph,userid:t.userInfo.objectId},params2:{content:a,userid:t.userInfo.objectId}},"1"!==t.type){e.next=12;break}return e.next=8,t.createBlog(s);case 8:e.sent&&(t.$toast({title:"发布成功"}),t.$router.go(-1)),e.next=17;break;case 12:if("2"!==t.type||!t.$route.query.blogid||t.userInfo.objectId!==t.blogData.userid){e.next=17;break}return e.next=15,t.updateBlog(s);case 15:e.sent&&(t.$toast({title:"更新成功"}),t.$router.go(-1));case 17:case"end":return e.stop()}},e,t)}))()},likeOpt:function(){this.userInfo?this.likeData.isLiked?this.unlikeBlog():this.likeBlog():this.$toast({title:"请先登录"})},collectOpt:function(){this.userInfo?this.collectData.isCollected?this.uncollectBlog():this.collectBlog():this.$toast({title:"请先登录"})},commentOpt:function(){var t=this;return p()(l.a.mark(function e(){var a,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.userInfo){e.next=3;break}return t.$toast({title:"请先登录"}),e.abrupt("return");case 3:if(""!==(a=t.commentContent.replace(/(^\s*)|(\s*$)/,""))){e.next=6;break}return e.abrupt("return");case 6:if(!(a.length>100)){e.next=9;break}return t.$toast({title:"评论不超过100字"}),e.abrupt("return");case 9:return n={userid:t.userInfo.objectId,comment:a,time:new Date},e.next=12,t.commentBlog(n);case 12:e.sent&&(t.commentContent="");case 14:case"end":return e.stop()}},e,t)}))()}})},M={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page-wrapper editor-wrapper"},[a("div",{staticClass:"page-header"},[a("div",{staticClass:"common-btn back-btn",on:{click:function(e){t.$router.go(-1)}}},[t._v("返回")]),t._v(" "),a("div",{staticClass:"page-header-content"},["1"===t.type||t.showDelete?a("edit-header",{attrs:{showDelete:t.showDelete},on:{"add-img":t.addImg,"clear-html":t.clearOpt,"deltet-blog":t.deleteOpt,"add-blog":t.submitOpt}}):t.author?a("div",{staticClass:"page-header-title"},[t._v(t._s(t.author.nickname)+"的博客")]):t._e()],1)]),t._v(" "),a("div",{staticClass:"page-body"},[a("div",{staticClass:"page-body-content"},[t.author?a("userCommon",{attrs:{userInfo:t.author}},[a("template",{slot:"user-others"},[a("div",{staticClass:"info-item"},[t._v("作者")])])],2):t._e(),t._v(" "),a("div",{staticClass:"content-wrapper",attrs:{id:"content-wrapper",contenteditable:"1"===t.type||t.showDelete},domProps:{innerHTML:t._s(t.blogData.content)}}),t._v(" "),"2"===t.type?a("div",{staticClass:"blog-info"},[a("div",{staticClass:"blog-options"},[a("div",{staticClass:"blog-time"},[t._v(t._s("1"===t.blogData.type?t.formatTime(t.blogData.createdAt)+"发布":t.formatTime(t.blogData.updatedAt)+"更新"))]),t._v(" "),a("div",{staticClass:"blog-view"},[t._v("浏览 "+t._s(t.blogData.view||0)+" 次")]),t._v(" "),a("div",{staticClass:"favor-btn common-btn",on:{click:t.likeOpt}},[t._v(t._s(t.likeData.isLiked?"已":"")+"喜欢")]),t._v(" "),t.blogData.userid!==t.userInfo.objectId?a("div",{staticClass:"favor-btn common-btn",on:{click:t.collectOpt}},[t._v(t._s(t.collectData.isCollected?"已":"")+"收藏")]):t._e()]),t._v(" "),t.likeData.list.length>0?a("div",{staticClass:"blog-likes blog-common"},[a("div",{staticClass:"title"},[t._v("喜欢（"+t._s(t.likeData.list.length)+"人）：")]),t._v(" "),a("div",{staticClass:"likes-conent"},t._l(t.likeData.list,function(t,e){return a("div",{key:e,staticClass:"likes-item"},[a("div",{staticClass:"likes-info"},[a("userCommon",{staticClass:"small-avatar",attrs:{userInfo:t}})],1)])}))]):t._e(),t._v(" "),t.collectData.list.length>0?a("div",{staticClass:"blog-likes blog-common"},[a("div",{staticClass:"title"},[t._v("收藏（"+t._s(t.collectData.list.length)+"人）：")]),t._v(" "),a("div",{staticClass:"likes-conent"},t._l(t.collectData.list,function(t,e){return a("div",{key:e,staticClass:"likes-item"},[a("div",{staticClass:"likes-info"},[a("userCommon",{staticClass:"small-avatar",attrs:{userInfo:t}})],1)])}))]):t._e(),t._v(" "),a("div",{staticClass:"blog-comments blog-common"},[a("div",{staticClass:"title"},[t._v("评论（"+t._s(t.comments.length)+"条）：")]),t._v(" "),a("div",{staticClass:"comments-content"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.commentContent,expression:"commentContent"}],staticClass:"comments-input",attrs:{cols:"30",rows:"3",placeholder:"不超过100字"},domProps:{value:t.commentContent},on:{input:function(e){e.target.composing||(t.commentContent=e.target.value)}}}),t._v(" "),a("div",{staticClass:"comments-options"},[a("div",{staticClass:"comments-tips"}),t._v(" "),a("div",{staticClass:"comments-btn common-btn",on:{click:t.commentOpt}},[t._v("提交评论")])]),t._v(" "),a("div",{staticClass:"comments-list"},t._l(t.comments,function(e,n){return a("div",{key:n,staticClass:"comments-item"},[a("div",{staticClass:"comments-user"},[a("userCommon",{staticClass:"small-avatar",attrs:{userInfo:e.user}}),t._v(" "),a("div",{staticClass:"comments-time"},[t._v(t._s(t.formatTime(e.time)))])],1),t._v(" "),a("div",{staticClass:"comments-detail"},[t._v(t._s(e.comment))])])}))])])]):t._e()],1)])])},staticRenderFns:[]};var W=a("VU/8")(N,M,!1,function(t){a("HUY3")},"data-v-a5aefd98",null).exports,G=Object(_.a)("user"),V=G.mapGetters,X=G.mapActions,Q={data:function(){return{type:"1",blogType:"1",isLoading:!1}},components:{blogCommon:A},computed:g()({},V(["userInfo","isAuthor","userData","blogList","isEnding"])),watch:{$route:function(){this.getData()}},created:function(){this.getData()},mounted:function(){var t,e=this,a=this;document.querySelector(".page-wrapper").addEventListener("scroll",(t=p()(l.a.mark(function t(n){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n.target.offsetHeight+n.target.scrollTop+100>=n.target.scrollHeight)||a.isLoading||a.isEnding){t.next=5;break}return a.isLoading=!0,t.next=4,a.viewBlog({userid:a.$route.query.userid,blogType:a.blogType,pageDown:!0});case 4:a.isLoading=!1;case 5:case"end":return t.stop()}},t,e)})),function(e){return t.apply(this,arguments)}))},methods:g()({},X(["getUser","viewBlog","updateUser"]),{formatTime:k,getData:function(){var t=this;return p()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.type="1",t.blogType="1",t.isLoading=!0,e.next=5,t.getUser({userid:t.$route.query.userid});case 5:return e.next=7,t.viewBlog({userid:t.$route.query.userid,blogType:t.blogType});case 7:t.isLoading=!1;case 8:case"end":return e.stop()}},e,t)}))()},editOpt:function(){this.type="2"},updateAvatar:function(){var t=this;S()(event.currentTarget.files[0]).then(function(e){t.userData.avatar=e.base64}).catch(function(){t.$toast("图片上传失败")})},saveOpt:function(){var t=this;return p()(l.a.mark(function e(){var a,n,s,o;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a={avatar:t.userData.avatar||"",nickname:(t.userData.nickname||"").replace(/\s/gi,""),location:(t.userData.location||"").replace(/\s/gi,""),qq:(t.userData.qq||"").replace(/\s/gi,""),wechat:(t.userData.wechat||"").replace(/\s/gi,""),sign:(t.userData.sign||"").replace(/\s/gi,"")},n=/^[\u3002|\uff1f|\uff01|\uff0c|\u3001|\uff1b|\uff1a|\u201c|\u201d|\u2018|\u2019|\uff08|\uff09|\u300a|\u300b|\u3008|\u3009|\u3010|\u3011|\u300e|\u300f|\u300c|\u300d|\ufe43|\ufe44|\u3014|\u3015|\u2026|\u2014|\uff5e|\ufe4f|\uffe5\u4e00-\u9fa5\w]{0,30}$/,/^[\u4e00-\u9fa5a-z0-9]{1,8}$/i.test(a.nickname)){e.next=5;break}return t.$toast({title:"请填写正确的昵称"}),e.abrupt("return");case 5:if(!a.location||/^[\u4e00-\u9fa5a-z0-9]{0,10}$/.test(a.location)){e.next=8;break}return t.$toast({title:"请填写正确的地址"}),e.abrupt("return");case 8:if(!a.qq||/^\d{7,12}$/.test(a.qq)){e.next=11;break}return t.$toast({title:"请填写正确的QQ号"}),e.abrupt("return");case 11:if(!a.wechat||/^[a-z0-9]+$/i.test(a.wechat)){e.next=14;break}return t.$toast({title:"请填写正确的微信"}),e.abrupt("return");case 14:if(!a.sign||n.test(a.sign)){e.next=17;break}return t.$toast({title:"请填写正确的签名"}),e.abrupt("return");case 17:s=!0,e.t0=l.a.keys(a);case 19:if((e.t1=e.t0()).done){e.next=28;break}if(o=e.t1.value,!a.hasOwnProperty(o)){e.next=26;break}if(a[o]===t.userInfo[o]){e.next=26;break}return s=!1,e.abrupt("break",28);case 26:e.next=19;break;case 28:if(!s){e.next=31;break}return t.type="1",e.abrupt("return");case 31:return e.next=33,t.updateUser(a);case 33:return e.sent&&(t.type="1",t.$toast({title:"保存成功"})),e.next=37,t.viewBlog({userid:t.$route.query.userid});case 37:case"end":return e.stop()}},e,t)}))()},changeBolgType:function(t){var e=this;return p()(l.a.mark(function a(){return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e.isLoading=!0,e.blogType=t,a.next=4,e.viewBlog({userid:e.$route.query.userid,blogType:e.blogType});case 4:e.isLoading=!1;case 5:case"end":return a.stop()}},a,e)}))()}})},Y={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page-wrapper user-wrapper"},[a("div",{staticClass:"page-header"},[a("div",{staticClass:"common-btn back-btn",on:{click:function(e){t.$router.go(-1)}}},[t._v("返回")]),t._v(" "),a("div",{staticClass:"page-header-content"},[a("div",{staticClass:"page-header-title"},[t._v(t._s(t.isAuthor?"我":t.userData.nickname)+"的主页")])])]),t._v(" "),a("div",{staticClass:"page-body"},[a("div",{staticClass:"page-body-content"},[a("div",{staticClass:"user-header"},[a("div",{staticClass:"left"},[a("div",{staticClass:"left-avatar"},[t.userData.avatar?a("div",{staticClass:"avatar background-image",style:{backgroundImage:"url("+t.userData.avatar+")"}}):a("div",{staticClass:"avatar background-image avatar-default"}),t._v(" "),"2"===t.type?a("input",{staticClass:"avatar-input",attrs:{type:"file",accept:"*.png,*.jpg,*.jpeg,*gif"},on:{change:function(e){return e.stopPropagation(),t.updateAvatar(e)}}}):t._e(),t._v(" "),"2"===t.type?a("div",{staticClass:"tip"},[t._v("更换头像")]):t._e()]),t._v(" "),a("div",{staticClass:"name"},["1"===t.type?a("span",[t._v(t._s(t.userData.nickname))]):a("input",{directives:[{name:"model",rawName:"v-model",value:t.userData.nickname,expression:"userData.nickname"}],attrs:{type:"text",placeholder:"8字以内"},domProps:{value:t.userData.nickname},on:{input:function(e){e.target.composing||t.$set(t.userData,"nickname",e.target.value)}}})]),t._v(" "),t.isAuthor?a("div",{staticClass:"btn-wrapper"},["1"===t.type?a("div",{staticClass:"btn common-btn",on:{click:t.editOpt}},[t._v("编辑")]):a("div",{staticClass:"btn common-btn",on:{click:t.saveOpt}},[t._v("保存")])]):t._e()]),t._v(" "),a("div",{staticClass:"right"},[t.isAuthor&&t.userData.username?a("div",{staticClass:"right-item"},[a("span",{staticClass:"right-title"},[t._v("账号：")]),t._v(" "),a("div",{staticClass:"right-content"},[a("span",[t._v(t._s(t.userData.username))])])]):t._e(),t._v(" "),a("div",{staticClass:"right-item"},[a("span",{staticClass:"right-title"},[t._v("地址：")]),t._v(" "),a("div",{staticClass:"right-content"},["1"===t.type?a("span",[t._v(t._s(t.userData.location||"未设置"))]):a("input",{directives:[{name:"model",rawName:"v-model",value:t.userData.location,expression:"userData.location"}],attrs:{type:"text",placeholder:"选填，不超过10个字"},domProps:{value:t.userData.location},on:{input:function(e){e.target.composing||t.$set(t.userData,"location",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"right-item"},[a("span",{staticClass:"right-title"},[t._v("QQ：")]),t._v(" "),a("div",{staticClass:"right-content"},["1"===t.type?a("span",[t._v(t._s(t.userData.qq||"未设置"))]):a("input",{directives:[{name:"model",rawName:"v-model",value:t.userData.qq,expression:"userData.qq"}],attrs:{type:"text",placeholder:"选填"},domProps:{value:t.userData.qq},on:{input:function(e){e.target.composing||t.$set(t.userData,"qq",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"right-item"},[a("span",{staticClass:"right-title"},[t._v("微信：")]),t._v(" "),a("div",{staticClass:"right-content"},["1"===t.type?a("span",[t._v(t._s(t.userData.wechat||"未设置"))]):a("input",{directives:[{name:"model",rawName:"v-model",value:t.userData.wechat,expression:"userData.wechat"}],attrs:{type:"text",placeholder:"选填"},domProps:{value:t.userData.wechat},on:{input:function(e){e.target.composing||t.$set(t.userData,"wechat",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"right-item"},[a("span",{staticClass:"right-title"},[t._v("签名：")]),t._v(" "),a("div",{staticClass:"right-content"},["1"===t.type?a("span",[t._v(t._s(t.userData.sign||"未设置"))]):a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.userData.sign,expression:"userData.sign"}],attrs:{cols:"30",rows:"2",placeholder:"选填，不超过30个字"},domProps:{value:t.userData.sign},on:{input:function(e){e.target.composing||t.$set(t.userData,"sign",e.target.value)}}})])])])]),t._v(" "),a("div",{staticClass:"user-body"},[a("div",{staticClass:"user-body-header"},[a("div",{staticClass:"btn-wrapper"},[a("div",{staticClass:"common-btn",class:["1"===t.blogType?"active":""],on:{click:function(e){t.changeBolgType("1")}}},[t._v(t._s(t.isAuthor?"我":"他")+"发布的")]),t._v(" "),a("div",{staticClass:"common-btn",class:["2"===t.blogType?"active":""],on:{click:function(e){t.changeBolgType("2")}}},[t._v(t._s(t.isAuthor?"我":"他")+"收藏的")])]),t._v(" "),a("div",{staticClass:"info-wrapper"},[t._v(t._s(t.formatTime(t.userData.createdAt,"2"))+" 注册")])]),t._v(" "),t._l(t.blogList,function(t,e){return a("blogCommon",{key:e,attrs:{blogData:t}})})],2),t._v(" "),a("div",{staticClass:"page-tip"},[t.isEnding?a("span",[t._v("没有更多啦~")]):!t.isEnding&&t.isLoading?a("span",[t._v("加载中~")]):!t.isEnding&&!t.isLoading&&t.blogList.length<=0?a("span",[t._v("这里什么也没有~")]):t._e()])])])])},staticRenderFns:[]};var J=a("VU/8")(Q,Y,!1,function(t){a("PXC+")},"data-v-6d30cccf",null).exports;s.a.use(i.a);var K=new i.a({routes:[{path:"/login",name:"login",component:y},{path:"/",name:"home",component:j},{path:"/blog",name:"blog",component:W},{path:"/user",name:"user",component:J}]}),Z=function(t){return t.userInfo},tt="https://api.leancloud.cn",et={baseAPI:tt,blogListAPI:tt+"/1.1/classes/blogList",blogsAPI:tt+"/1.1/classes/blogs",likesAPI:tt+"/1.1/classes/likes",commentsAPI:tt+"/1.1/classes/comments",collectsAPI:tt+"/1.1/classes/collects",userAPI:tt+"/1.1/users",loginAPI:tt+"/1.1/login"},at="gytm4jB6IQzdW0i28v8UAY4H-gzGzoHsz",nt="WnCTEGn77xqkv2IM7nml1Ts0",st=a("//Fk"),ot=a.n(st),rt=a("mtWM"),it=a.n(rt),ct=a("JnRc");a.n(ct).a.init({appId:at,appKey:nt});var lt=(new Date).getTime(),ut=it.a.create({baseURL:et.baseAPI,headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json","X-LC-Id":at,"X-LC-Sign":f()(lt.toString()+nt)+","+lt},timeout:5e3}),pt={};["get","post","put","delete"].forEach(function(t){pt[t]=function(e,a,n){return new ot.a(function(s,o){ut[t](e,a,n).then(function(t){t.status>=200&&t.status<300?s(t.data):(v({title:"请求错误"}),o(t))}).catch(function(t){v({title:t.response.data&&t.response.data.error||"请求错误"}),o(t)})})}});var dt=pt,gt={regist:function(t,e){var a=this,n=t.dispatch;return p()(l.a.mark(function t(){var s;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,dt.post(et.userAPI,e);case 3:return t.next=5,n("login",e);case 5:return s=t.sent,t.abrupt("return",s);case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return",!1);case 12:case"end":return t.stop()}},t,a,[[0,9]])}))()},login:function(t,e){var a=this,n=t.commit;return p()(l.a.mark(function t(){var s;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,dt.post(et.loginAPI,e);case 3:return s=t.sent,n("setUserInfo",s),t.abrupt("return",s);case 8:return t.prev=8,t.t0=t.catch(0),t.abrupt("return",!1);case 11:case"end":return t.stop()}},t,a,[[0,8]])}))()},logout:function(t){(0,t.commit)("clearUserInfo")},getUser:function(t,e){var a=this;t.commit;return p()(l.a.mark(function t(){var n;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,dt.get(et.userAPI+"/"+e.userid,{params:{keys:"nickname,avatar,sign,location"}});case 3:return n=t.sent,t.abrupt("return",n);case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",{});case 10:case"end":return t.stop()}},t,a,[[0,7]])}))()}},mt=a("woOf"),ft=a.n(mt),vt=a("mvHQ"),bt=a.n(vt),ht={setUserInfo:function(t,e){var a=t.userInfo?JSON.parse(bt()(t.userInfo)):{};t.userInfo=ft()(a,e),function(t,e,a){a||(a=1);var n=new Date;n.setTime(n.getTime()+24*a*60*60*1e3),document.cookie=t+"="+escape(e)+";expires="+n.toGMTString()}("Blog_userInfo",bt()({objectId:t.userInfo.objectId,sessionToken:t.userInfo.sessionToken}))},clearUserInfo:function(t){t.userInfo=null,function(t){var e=new Date;e.setTime(e.getTime()-1);var a=b(t);a&&(document.cookie=t+"="+a+";expires="+e.toGMTString())}("Blog_userInfo")}},kt={namespaced:!0,state:{page:1,per:10,total:1,isEnding:!1,blogList:[]},getters:{blogList:function(t){return t.blogList},isEnding:function(t){return t.isEnding}},actions:{getBlogList:function(t,e){var a=this,n=t.dispatch,s=t.commit,o=t.state,r=t.rootState;return p()(l.a.mark(function t(){var i,c,u,p,d,g;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,i={params:{order:"-createdAt",limit:o.per,skip:0,count:1}},!e||!e.pageDown){t.next=11;break}if(i.params.limit=(o.page+1)*o.per,i.params.skip=o.page*o.per,!(o.total<=i.params.skip)){t.next=8;break}return s("setIsEnding",!0),t.abrupt("return",!0);case 8:s("setPage",o.page+1),t.next=13;break;case 11:s("setIsEnding",!1),s("setPage",1);case 13:return t.next=15,dt.get(et.blogListAPI,i);case 15:if(!(c=t.sent)||!c.results){t.next=34;break}if(s("setTotal",c.count||1),!r.userInfo||!r.userInfo.objectId){t.next=23;break}return t.next=21,n("getUser",{userid:r.userInfo.objectId},{root:!0});case 21:u=t.sent,s("setUserInfo",u,{root:!0});case 23:p=0;case 24:if(!(p<c.results.length)){t.next=33;break}return d=c.results[p],t.next=28,n("getUser",{userid:d.userid},{root:!0});case 28:g=t.sent,d.user=g||{};case 30:p++,t.next=24;break;case 33:e&&e.pageDown?s("setBlogList",o.blogList.concat(c.results)):s("setBlogList",c.results);case 34:return t.abrupt("return",!0);case 37:return t.prev=37,t.t0=t.catch(0),t.abrupt("return",!1);case 40:case"end":return t.stop()}},t,a,[[0,37]])}))()}},mutations:{setPage:function(t,e){t.page=e},setTotal:function(t,e){t.total=e},setIsEnding:function(t,e){t.isEnding=e},setBlogList:function(t,e){t.blogList=e}}},_t={namespaced:!0,state:{blogData:{},author:null,showDelete:!1,likeData:{list:[],isLiked:!1},collectData:{list:[],isCollected:!1},comments:[]},getters:{userInfo:function(t,e,a){return a.userInfo},blogData:function(t){return t.blogData},author:function(t){return t.author},showDelete:function(t){return t.showDelete},likeData:function(t){return t.likeData},collectData:function(t){return t.collectData},comments:function(t){return t.comments.reverse()}},actions:{getBlog:function(t,e){var a=this,n=t.dispatch,s=t.commit,o=t.rootState;return p()(l.a.mark(function t(){var r,i,c;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,s("initData"),"1"!==e.type){t.next=6;break}s("setAuthor",o.userInfo),t.next=21;break;case 6:if("2"!==e.type||!e.blogid){t.next=21;break}return t.next=9,dt.get(""+et.blogsAPI,{params:{where:{blogid:e.blogid}}});case 9:if(!((r=t.sent)&&r.results&&r.results[0])){t.next=21;break}return i=r.results[0],t.next=14,n("getUser",{userid:i.userid},{root:!0});case 14:c=t.sent,s("setBlog",i),s("setAuthor",c||{}),s("setShowDelete",o.userInfo&&i.userid===o.userInfo.objectId),n("viewLikes",{likeid:i.likeid}),n("viewCommons",{commentid:i.commentid}),n("viewCollects",{collectid:i.collectid});case 21:return t.abrupt("return",!0);case 24:return t.prev=24,t.t0=t.catch(0),t.abrupt("return",!1);case 27:case"end":return t.stop()}},t,a,[[0,24]])}))()},createBlog:function(t,e){var a=this;t.commit;return p()(l.a.mark(function t(){var n,s,o,r;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,dt.post(et.blogListAPI,ft()({},e.params1,{type:"1"}));case 3:return n=t.sent,t.next=6,dt.post(et.likesAPI,{blogid:n.objectId,users:[]});case 6:return s=t.sent,t.next=9,dt.post(et.commentsAPI,{blogid:n.objectId,comments:[]});case 9:return o=t.sent,t.next=12,dt.post(et.collectsAPI,{blogid:n.objectId,users:[]});case 12:return r=t.sent,t.next=15,dt.post(et.blogsAPI,ft()({},e.params2,{type:"1",blogid:n.objectId,likeid:s.objectId,commentid:o.objectId,collectid:r.objectId}));case 15:return t.abrupt("return",!0);case 18:return t.prev=18,t.t0=t.catch(0),t.abrupt("return",!1);case 21:case"end":return t.stop()}},t,a,[[0,18]])}))()},updateBlog:function(t,e){var a=this,n=t.state;return p()(l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,dt.put(et.blogListAPI+"/"+n.blogData.blogid,ft()({},e.params1,{type:"2"}));case 3:return t.next=5,dt.put(et.blogsAPI+"/"+n.blogData.objectId,ft()({},e.params2,{blogid:n.blogData.blogid,type:"2"}));case 5:return t.abrupt("return",!0);case 8:return t.prev=8,t.t0=t.catch(0),t.abrupt("return",!1);case 11:case"end":return t.stop()}},t,a,[[0,8]])}))()},deleteBlog:function(t){var e=this,a=t.state;return p()(l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,dt.delete(et.blogListAPI+"/"+a.blogData.blogid);case 3:return t.next=5,dt.delete(et.blogsAPI+"/"+a.blogData.objectId);case 5:return t.next=7,dt.delete(et.likesAPI+"/"+a.blogData.likeid);case 7:return t.next=9,dt.delete(et.commentsAPI+"/"+a.blogData.commentid);case 9:return t.next=11,dt.delete(et.collectsAPI+"/"+a.blogData.collectid);case 11:return t.abrupt("return",!0);case 14:return t.prev=14,t.t0=t.catch(0),t.abrupt("return",!1);case 17:case"end":return t.stop()}},t,e,[[0,14]])}))()},viewBlog:function(t){var e=this,a=t.state;return p()(l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,dt.put(et.blogListAPI+"/"+a.blogData.blogid,{view:{__op:"Increment",amount:1}});case 2:return t.next=4,dt.put(et.blogsAPI+"/"+a.blogData.objectId,{view:{__op:"Increment",amount:1}});case 4:case"end":return t.stop()}},t,e)}))()},viewLikes:function(t,e){var a=this,n=t.dispatch,s=t.commit,o=t.rootState;return p()(l.a.mark(function t(){var r,i,c,u,p,d;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,dt.get(et.likesAPI+"/"+e.likeid);case 3:if(!(r=t.sent)||!r.users){t.next=20;break}i=[],c=!1,u=0;case 8:if(!(u<r.users.length)){t.next=18;break}return p=r.users[u],o.userInfo&&p===o.userInfo.objectId&&(c=!0),t.next=13,n("getUser",{userid:p},{root:!0});case 13:d=t.sent,i.push(d||{});case 15:u++,t.next=8;break;case 18:s("setLikeList",i),s("setIsLiked",c);case 20:return t.abrupt("return",!0);case 23:return t.prev=23,t.t0=t.catch(0),t.abrupt("return",!1);case 26:case"end":return t.stop()}},t,a,[[0,23]])}))()},likeBlog:function(t){var e=this,a=t.state,n=t.dispatch,s=t.rootState;return p()(l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,dt.put(et.blogListAPI+"/"+a.blogData.blogid,{like:{__op:"Increment",amount:1}});case 3:return t.next=5,dt.put(et.likesAPI+"/"+a.blogData.likeid,{users:{__op:"AddUnique",objects:[s.userInfo.objectId]}});case 5:return n("viewLikes",{likeid:a.blogData.likeid}),t.abrupt("return",!0);case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return",!1);case 12:case"end":return t.stop()}},t,e,[[0,9]])}))()},unlikeBlog:function(t){var e=this,a=t.state,n=t.dispatch,s=t.rootState;return p()(l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,dt.put(et.blogListAPI+"/"+a.blogData.blogid,{like:{__op:"Increment",amount:-1}});case 3:return t.next=5,dt.put(et.likesAPI+"/"+a.blogData.likeid,{users:{__op:"Remove",objects:[s.userInfo.objectId]}});case 5:return n("viewLikes",{likeid:a.blogData.likeid}),t.abrupt("return",!0);case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return",!1);case 12:case"end":return t.stop()}},t,e,[[0,9]])}))()},viewCommons:function(t,e){var a=this,n=t.dispatch,s=t.commit;return p()(l.a.mark(function t(){var o,r,i,c;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,dt.get(et.commentsAPI+"/"+e.commentid);case 3:if(!(o=t.sent)||!o.comments){t.next=16;break}r=0;case 6:if(!(r<o.comments.length)){t.next=15;break}return i=o.comments[r],t.next=10,n("getUser",{userid:i.userid},{root:!0});case 10:c=t.sent,i.user=c||{};case 12:r++,t.next=6;break;case 15:s("setComments",o.comments);case 16:return t.abrupt("return",!0);case 19:return t.prev=19,t.t0=t.catch(0),t.abrupt("return",!1);case 22:case"end":return t.stop()}},t,a,[[0,19]])}))()},commentBlog:function(t,e){var a=this,n=t.state,s=t.dispatch;return p()(l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,dt.put(et.blogListAPI+"/"+n.blogData.blogid,{comment:{__op:"Increment",amount:1}});case 3:return t.next=5,dt.put(et.commentsAPI+"/"+n.blogData.commentid,{comments:{__op:"Add",objects:[e]}});case 5:return s("viewCommons",{commentid:n.blogData.commentid}),t.abrupt("return",!0);case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return",!1);case 12:case"end":return t.stop()}},t,a,[[0,9]])}))()},viewCollects:function(t,e){var a=this,n=t.dispatch,s=t.commit,o=t.rootState;return p()(l.a.mark(function t(){var r,i,c,u,p,d;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,dt.get(et.collectsAPI+"/"+e.collectid);case 3:if(!(r=t.sent)||!r.users){t.next=20;break}i=[],c=!1,u=0;case 8:if(!(u<r.users.length)){t.next=18;break}return p=r.users[u],o.userInfo&&p===o.userInfo.objectId&&(c=!0),t.next=13,n("getUser",{userid:p},{root:!0});case 13:d=t.sent,i.push(d||{});case 15:u++,t.next=8;break;case 18:s("setCollectList",i),s("setIsCollected",c);case 20:return t.abrupt("return",!0);case 23:return t.prev=23,t.t0=t.catch(0),t.abrupt("return",!1);case 26:case"end":return t.stop()}},t,a,[[0,23]])}))()},collectBlog:function(t){var e=this,a=t.state,n=t.dispatch,s=t.rootState;return p()(l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,dt.put(et.blogListAPI+"/"+a.blogData.blogid,{collects:{__op:"AddUnique",objects:[s.userInfo.objectId]}});case 3:return t.next=5,dt.put(et.collectsAPI+"/"+a.blogData.collectid,{users:{__op:"AddUnique",objects:[s.userInfo.objectId]}});case 5:return n("viewCollects",{collectid:a.blogData.collectid}),t.abrupt("return",!0);case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return",!1);case 12:case"end":return t.stop()}},t,e,[[0,9]])}))()},uncollectBlog:function(t){var e=this,a=t.state,n=t.dispatch,s=t.rootState;return p()(l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,dt.put(et.blogListAPI+"/"+a.blogData.blogid,{collects:{__op:"Remove",objects:[s.userInfo.objectId]}});case 3:return t.next=5,dt.put(et.collectsAPI+"/"+a.blogData.collectid,{users:{__op:"Remove",objects:[s.userInfo.objectId]}});case 5:return n("viewCollects",{collectid:a.blogData.collectid}),t.abrupt("return",!0);case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return",!1);case 12:case"end":return t.stop()}},t,e,[[0,9]])}))()}},mutations:{initData:function(t){t.blogData={},t.author=null,t.showDelete=!1,t.likeData={list:[],isLiked:!1},t.collectData={list:[],isCollected:!1},t.comments=[]},setBlog:function(t,e){t.blogData=e},setAuthor:function(t,e){t.author=e},setShowDelete:function(t,e){t.showDelete=e},setLikeList:function(t,e){t.likeData.list=e},setIsLiked:function(t,e){t.likeData.isLiked=e},setComments:function(t,e){t.comments=e},setCollectList:function(t,e){t.collectData.list=e},setIsCollected:function(t,e){t.collectData.isCollected=e}}},Ct={namespaced:!0,state:{isAuthor:!1,userData:{},blogList:[],pageData:{page:1,per:10,total:1,isEnding:!1}},getters:{userInfo:function(t,e,a){return a.userInfo},userData:function(t){return t.userData},blogList:function(t){return t.blogList},isEnding:function(t){return t.pageData.isEnding},isAuthor:function(t){return t.isAuthor}},actions:{getUser:function(t,e){var a=this,n=t.commit,s=t.rootState;return p()(l.a.mark(function t(){var o,r,i;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n("initData"),o=!1,r={params:{keys:"-email,-username"}},s.userInfo&&e.userid===s.userInfo.objectId&&(o=!0,r={}),n("setIsAuthor",o),t.next=8,dt.get(et.userAPI+"/"+e.userid,r);case 8:return(i=t.sent)&&n("setUserData",i),t.abrupt("return",!0);case 13:return t.prev=13,t.t0=t.catch(0),t.abrupt("return",!1);case 16:case"end":return t.stop()}},t,a,[[0,13]])}))()},viewBlog:function(t,e){var a=this,n=t.dispatch,s=t.commit,o=t.state;return p()(l.a.mark(function t(){var r,i,c,u,p;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r={params:{where:{userid:e.userid},limit:o.pageData.per,skip:0,count:1}},"1"===e.blogType?r.params.where={userid:e.userid}:"2"===e.blogType&&(r.params.where={collects:e.userid}),!e.pageDown){t.next=12;break}if(r.params.limit=(o.pageData.page+1)*o.pageData.per,r.params.skip=o.pageData.page*o.pageData.per,!(o.pageData.total<=r.params.skip)){t.next=9;break}return s("setIsEnding",!0),t.abrupt("return",!0);case 9:s("setPage",o.pageData.page+1),t.next=14;break;case 12:s("setIsEnding",!1),s("setPage",1);case 14:return t.next=16,dt.get(""+et.blogListAPI,r);case 16:if(!(i=t.sent)||!i.results){t.next=30;break}s("setTotal",i.count||1),c=0;case 20:if(!(c<i.results.length)){t.next=29;break}return u=i.results[c],t.next=24,n("getUser",{userid:u.userid},{root:!0});case 24:p=t.sent,u.user=p||{};case 26:c++,t.next=20;break;case 29:e.pageDown?s("setBlogList",o.blogList.concat(i.results)):s("setBlogList",i.results);case 30:return t.abrupt("return",!0);case 33:return t.prev=33,t.t0=t.catch(0),t.abrupt("return",!1);case 36:case"end":return t.stop()}},t,a,[[0,33]])}))()},updateUser:function(t,e){var a=this,n=t.dispatch,s=t.rootState;return p()(l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,dt.put(et.userAPI+"/"+s.userInfo.objectId,e,{headers:{"X-LC-Session":s.userInfo.sessionToken}});case 3:return t.next=5,n("getUser",{userid:s.userInfo.objectId});case 5:return t.abrupt("return",!0);case 8:return t.prev=8,t.t0=t.catch(0),t.abrupt("return",!1);case 11:case"end":return t.stop()}},t,a,[[0,8]])}))()}},mutations:{initData:function(t){t.userData={},t.blogList=[],t.isAuthor=!1},setUserData:function(t,e){t.userData=e},setIsAuthor:function(t,e){t.isAuthor=e},setPage:function(t,e){t.pageData.page=e},setTotal:function(t,e){t.pageData.total=e},setIsEnding:function(t,e){t.pageData.isEnding=e},setBlogList:function(t,e){t.blogList=e}}};s.a.use(_.b);var xt=new _.b.Store({state:{userInfo:b("Blog_userInfo")&&JSON.parse(b("Blog_userInfo"))||null},getters:n,actions:gt,mutations:ht,modules:{home:kt,blog:_t,user:Ct}});a("4wdT");s.a.config.productionTip=!1,s.a.prototype.$toast=v,new s.a({el:"#app",router:K,store:xt,components:{App:r},template:"<App/>"})},"PXC+":function(t,e){},"gnv+":function(t,e){},kiI7:function(t,e){},mz16:function(t,e){},pgqj:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.a9df0cac2463b3dcecf2.js.map